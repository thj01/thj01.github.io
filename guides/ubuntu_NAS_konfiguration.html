<!DOCTYPE html>
<html lang="da">
<head>
  <title>NAS konfiguration</title>
  <link rel="icon" href="../images/favicon.png">
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  
  <link href='http://fonts.googleapis.com/css?family=Ubuntu+Mono|Ubuntu|Ubuntu+Condensed' rel='stylesheet' type='text/css'>

  <link rel="stylesheet" href="../css/bootstrap.min.css">
  <link rel="stylesheet" href="../css/jquery-ui.min.css">
  <link rel="stylesheet" href="../css/jquery.tocify.css">
  <link rel="stylesheet" href="../css/style_new.css" />
<!-- Scripts in bottom to speed up pageload-->
 

</head>
<body>
	
	
<div class="container-fluid">

<div class="row-fluid">
	
<div class="col-xs-3">
	
	<div id="toc">
	
		<div id="toc_headline"></div>
	
	</div>

</div><!-- Start slut 1. kolonne - TOC -->
	
<div class="col-xs-9">
	
<div class="title">Ubuntu Nas <br/>Konfiguration</div>

<p>Nu hvor vi har installeret grundstammen i vores NAS, og konfigureret netværket, så skal vi til at sætte tjenester og programmer op.</p>

<p>Jeg vil anbefale at du anvender <span class="inl_cmd">ssh</span> til dette, da det vil give dig mulighed for at kopiere kommandoer og konfigurationsfiler fra denne hjemmeside.</p>

<h1>sudo</h1>

<p>Du lagde sikkert mærke til, at der nogle gange stod <span class="inl_cmd">sudo</span> foran nogle af kommandoerne. Det er en af de rigtig smarte ting ved Linux.</p>

<p><span class="inl_cmd">sudo</span> betyder <b>SU</b>peruser <b>DO</b>, og er en smart måde som man anvender til at give nogle bruger administratorrettigheder. Det gør man ved at sætte dem i <span class="inl_cmd">sudo</span>-gruppen. Den bruger du oprettede under installationen er automatisk tilføjet til denne gruppe, og derfor kan du lave systemarbejde.</p>

<p>Lad os prøve at et eksempel, hvor vi genstarter netværkstjenesten. Kør kommandoen: <span class="inl_cmd">service networking restart</span> - altså uden <span class="inl_cmd">sudo</span>.</p>

<pre class="black">
tj@NAS:~$ service networking restart
<span class="red">==== AUTHENTICATING FOR org.freedesktop.systemd1.manage-units ===</span>
Authentication is required to restart 'networking.service'.
Authenticating as: Thomas Jensen,,, (tj)
Password: 
</pre>

<p>Her brokker programmet sig, fordi du ikke har rettighederne til at køre det. Men som en service får du muligheden for at indtaste dit password, så netværket kan genstartes.</p>

<p>Havde du gjort det "rigtigt" med <span class="inl_cmd">sudo</span> ville du have fået følgende output:</p>

<pre class="black">
tj@NAS:~$ sudo service networking restart 
[sudo] adgangskode for tj: 
</pre>

<p>Altså ingen brok, men bare en bekræftelse på at du tilhører <span class="inl_cmd">sudo</span>-gruppen.</p>

<blockquote>
	<p>
		Læg mærke til, at hvis du kører flere <span class="inl_cmd">sudo</span> kommandoer efter hinanden, så skal du ikke indtaste dit password. Det skyldes, at Ubuntu husker det et kort stykke tid.
	</p>
	
	<p>Af samme årsag bør man også logge af en computer før man forlader den, for at andre ikke kan misbruge dine rettigheder. Det gøres med kommandoen: <span class="inl_cmd">exit</span>, eller ved at lukke terminalvinduet.</p>
</blockquote>


<h1>Opdatering</h1>

<p>Ubuntu opdateres ved hjælp af det som kaldes <span class="inl_cmd">repositories</span>. et repositorie har hele tiden den nyeste version af programmet der passer til den version af Ubuntu man kører med. Så for at opdatere skal man altså sammenligne de programmer man har installeret med dem som ligger i repository.</p>

<p>Det smarte ved dette system er, at man kan tilføje og fjerne repositories efter behov - og derved få fat i de programmer man ønsker.</p>

<h2>Ændre lokalitet</h2>

<p>Som udgangspunkt henter den installation vi har lavet sine opdateringer fra lokale servere i DK. Det er min erfaring at de nogle gange er langsommere end de generelle. Det er en ting der kun skal laves en gang.</p>

<p>Vi ændrer det ved at køre følgende kommandoer:</p>

<ul class="none fat_li">
	
	<li>Laver en backup af konfigurationsfilen hvis noget skulle gå galt. Bør man gøre som en helt naturlig del af ens arbejdsproces</li>
	
		<code class="cmd">sudo cp /etc/apt/sources.list /etc/apt/sources.list.backup</code>
		
	<li>Erstat alle forekomster af <span class="inl_cmd">dk.archive</span> med <span class="inl_cmd">archive</span></li>
	
		<code class="cmd">sudo sed -i s/dk.archive/archive/ /etc/apt/sources.list</code>
		<p></p>
	
</ul>

<details>

	<summary>Hvis det går galt</summary>

	<p>Vi lavede en backup med linien:</p>
	
	<code class="cmd">sudo cp /etc/apt/sources.list /etc/apt/sources.list.backup</code>
	
	<p>Det vi gjorde var faktisk at kopiere <span class="inl_cmd">/etc/apt/sources.list</span> til en ny fil der hedder <span class="inl_cmd">/etc/apt/sources.list.backup</span></p>
	
	<p>For at omgøre dette gør vi det omvendte</p>

	<code class="cmd">sudo cp /etc/apt/sources.list.backup /etc/apt/sources.list</code>

	<p>Husk: Rigtige mænd tager ikke backup ... de græder bare ;)</p>
	
	
</details>

<h2>Opdatering</h2>

<p>Opdateringen består af to processer:</p>

<ul class="none fat_li">
	<li>Opdatering af repositories</li>
	
		<code class="cmd">sudo apt update</code>

	
	<li>Opdatering af programmer</li>
	
		<code class="more_cmd">sudo apt upgrade</code>

	<li>Vil du gøre det i en linie</li>

		<code class="cmd">sudo apt update && sudo apt upgrade</code>

</ul>

<p>Læg mærke til at du får en liste over alle de filder skal opgraderes, hvor meget der skal hentes, og hvad det betyder for diskpladsen. Herunder kan du se resultatet på min nyinstallation:</p>

<pre class="black">
tj@NAS:~$ sudo apt upgrade
Indlæser pakkelisterne... Færdig
Opbygger afhængighedstræ        
Læser tilstandsoplysninger... Færdig
Beregner opgraderingen... Færdig
Følgende NYE pakker vil blive installeret:
  linux-headers-4.10.0-38 linux-headers-4.10.0-38-generic
  linux-image-4.10.0-38-generic linux-image-extra-4.10.0-38-generic
Følgende pakker vil blive opgraderet:
  apparmor bind9-host ca-certificates cryptsetup cryptsetup-bin curl
  distro-info-data dnsmasq-base dnsutils gcc-5-base git git-man
  grub-legacy-ec2 initramfs-tools initramfs-tools-bin initramfs-tools-core
  iproute2 libapparmor-perl libapparmor1 libbind9-140 libcryptsetup4
  libcurl3-gnutls libdns-export162 libdns162 libgnutls-openssl27 libgnutls30
  libicu55 libidn11 libisc-export160 libisc160 libisccc140 libisccfg140
  liblwres141 libmspack0 libpam-systemd libplymouth4 libpython3.5
  libpython3.5-minimal libpython3.5-stdlib libssl1.0.0 libstdc++6 libsystemd0
  libudev1 libxml2 linux-firmware linux-generic-hwe-16.04
  linux-headers-generic-hwe-16.04 linux-image-generic-hwe-16.04 logrotate lshw
  lxd lxd-client mdadm openssl plymouth plymouth-theme-ubuntu-text
  python3-distupgrade python3-update-manager python3.5 python3.5-minimal
  resolvconf snapd systemd systemd-sysv tcpdump tzdata
  ubuntu-release-upgrader-core udev unattended-upgrades update-manager-core
  update-notifier-common vlan wget xfsprogs
74 opgraderes, 4 nyinstalleres, 0 afinstalleres og 0 opgraderes ikke.
156 MB skal hentes fra arkiverne.
Efter denne handling, vil 366 MB yderligere diskplads være brugt.
Vil du fortsætte? [J/n] 
</pre>

<p>Når du klikker <kbd>j</kbd> bliver alle programmer opdateret.</p>

<h1>SSH</h1>

<p>Så længe serveren kun bliver brugt lokalt kan man egentlig nøjes med den grundopsætning som den kommer med.</p>

<p>Jeg vil dog anbefale at man laver to ændringer, som begge skal laves i filen <span class="inl_cmd">/etc/ssh/sshd_config</span>:</p>

<p>Lav en backup og åbn filen med kommandoen:</p>

<code class="cmd">sudo cp /etc/ssh/sshd_config /etc/ssh/sshd_config.backup </code>

<code class="cmd">sudo nano /etc/ssh/sshd_config </code>

<h2>Fjern root adgang</h2>

<p>På denne måde sikrer man sig at brugeren kun har de rettigheder, som der er givet på NAS-serveren</p>

<p>Ændr linien:</p>

<pre class="black">
PermitRootLogin prohibit-password
</pre>

<p>til:</p>

<pre class="black">
PermitRootLogin no
</pre>

<h2>Ændr tilladte brugere</h2>

<p>Her kan du administrere hvem der har adgang til at bruge ssh</p>

<p>Gå ned i bunden af filen og tilføj linien (hvor du erstatter <span class="inl_cmd">tj</span> med dit brugernavn):</p>

<pre class="black">
Allowusers tj
</pre>

<h2>Aktiver ændringer</h2>

<p>For at aktivere vores ændringer skal vi genstarte tjenesten:</p>

<code class="cmd">sudo service ssh reload</code>


<h1>Webserver</h1>

<p>For at kunne tilgå vores server fra en browser skal vi først have installereret <abbr title="Linux Apache MySQL PHP">LAMP</abbr>, som er en komplet webserverløsning til Linux.</p>

<p>Først installerer vi tasksel</p>

<code class="cmd">sudo apt install tasksel</code>

<p>Herefter installerer vi LAMP-serveren ved hjælp af tasksel</p>

<code class="cmd">sudo tasksel install lamp-server</code>

<p>Tjek at webserveren kører ved at indtaste serverens IP-adresse i en browser:</p>

<figure id="">

	<img class="p90" src="images/VirtualBox_Ubuntu NAS_66.png" alt="" title="" />

	<figcaption></figcaption>

</figure>



<h2>Konfigurer MySQL</h2>



<p>Som standard er MySQL serveren installeret uden at være sikret. For at sikre MySQL skal vi køre følgende script:</p>

<code class="cmd">sudo mysql_secure_installation</code>

<p>Herunder er der en gennemgang af scriptet</p>

<h3>Sæt root password</h3>

<p>Som standard installeres MySQL uden sikkerhed. Det skal vi have ændret på. Der skal gøres 2 ting</p>

<ul class="none fat_li">
	<li>Password kontrol</li>
	
		<p>For at sikre at brugerne vælger gode passwords kan man oprette en funktion der kontrollerer dette.</p>
		
		<p>Her er den sat til niveau 0, som reelt kun sikrer at det er over 8 tegn langt. Skal den i produktion (anvendes i tilgængelige miljøer) bør man vælge niveau 2</p>
	
	<li>Sætte password</li>
	
		<p>Indtast og genindtast det valgte root-password-</p>
</ul>


<pre class="black">tj@nas:~$ sudo mysql_secure_installation

Securing the MySQL server deployment.

Connecting to MySQL using a blank password.

VALIDATE PASSWORD PLUGIN can be used to test passwords
and improve security. It checks the strength of password
and allows the users to set only those passwords which are
secure enough. Would you like to setup VALIDATE PASSWORD plugin?

Press y|Y for Yes, any other key for No: <kbd>y</kbd>

There are three levels of password validation policy:

LOW    Length >= 8
MEDIUM Length >= 8, numeric, mixed case, and special characters
STRONG Length >= 8, numeric, mixed case, special characters and dictionary file

Please enter 0 = LOW, 1 = MEDIUM and 2 = STRONG: <kbd>0</kbd>
Please set the password for root here.

New password: <span class="red">&larr; Indtast root-password</span><kbd>Enter</kbd>

Re-enter new password: <span class="red">&larr; Genindtast root-password</span><kbd>Enter</kbd>

Estimated strength of the password: 50 
Do you wish to continue with the password provided?(Press y|Y for Yes, any other key for No) : <kbd>y</kbd>
</pre>

<h3>Fjern anonyme brugere</h3>

<p>MySQL har som standard installeret nogle anonyme brugere. De er gode til test, men vi vælger at fjerne dem.</p>

<pre class="black">By default, a MySQL installation has an anonymous user,
allowing anyone to log into MySQL without having to have
a user account created for them. This is intended only for
testing, and to make the installation go a bit smoother.
You should remove them before moving into a production
environment.

Remove anonymous users? (Press y|Y for Yes, any other key for No) : <kbd>y</kbd>
Success.
</pre>

<h3>Root fjernadgang</h3>

<p>Man bør også fjerne muligheden for at root-brugeren kan tilgå databasen fra andre maskiner en den, som den er installeret på. Skal MySQL administreres over netværk bør det være over en SSH forbindelse</p>

<pre class="black">Normally, root should only be allowed to connect from
'localhost'. This ensures that someone cannot guess at
the root password from the network.

Disallow root login remotely? (Press y|Y for Yes, any other key for No) : <kbd>y</kbd>
Success.
</pre>

<h3>Fjern test-database</h3>

<p>MySQL kommer med en testdatabase installeret. Den er ikke nødvendig, så vi fjerner den</p>

<pre class="black">By default, MySQL comes with a database named 'test' that
anyone can access. This is also intended only for testing,
and should be removed before moving into a production
environment.


Remove test database and access to it? (Press y|Y for Yes, any other key for No) : <kbd>y</kbd>
 - Dropping test database...
Success.

 - Removing privileges on test database...
Success.
</pre>

<h3>Genindlæs database</h3>

<p>For at få ændringerne til at slå igennem genindlæser vi databasen.</p>

<pre class="black">Reloading the privilege tables will ensure that all changes
made so far will take effect immediately.

Reload privilege tables now? (Press y|Y for Yes, any other key for No) : <kbd>y</kbd>
Success.

All done!
</pre>

<h3>Test database</h3>

<p>For at teste at databasen er konfigureret korrekt logger vi ind på den:</p>

<pre class="black">tj@nas:~$ sudo mysql -u root -p
[sudo] password for tj: <span class="red">&larr; Indtast system password</span>
Enter password: <span class="red">&larr; Indtast mysql root-password</span>
Welcome to the MySQL monitor.  Commands end with ; or \g.
Your MySQL connection id is 4
Server version: 5.7.22-0ubuntu18.04.1 (Ubuntu)

Copyright (c) 2000, 2018, Oracle and/or its affiliates. All rights reserved.

Oracle is a registered trademark of Oracle Corporation and/or its
affiliates. Other names may be trademarks of their respective
owners.

Type 'help;' or '\h' for help. Type '\c' to clear the current input statement.

mysql> quit <span class="red">&larr; Indtast "quit", for at afslutte MySQL</span>
Bye
tj@nas:~$
</pre>




<h1>Installer WebMin</h1>

<p>Webmin bliver af forskellige årsager ikke tilbudt ved hjælp af de normale repositories. Derfor skal vi lave lidt indledende arbejde selv (brug samme metode som ovenfor)</p>

<p>Vi skal:</p>

<ol class="">
	<li>Tilføje Webmins eget repository</li>
	<li>Installere en GPG-nøgle, sådan at vi sikerer os at opdateringerne kommer fra den rigtige kilde</li>
	<li>Opdatere vores repositories</li>
	<li>Installere <span class="inl_cmd">apt-transport-https</span> og <span class="inl_cmd">webmin</span>.</li>
</ol>

<p>Udfør:</p>

<ul class="fat_li none">
	<li>Tilføj følgende linie i bunden af <span class="inl_cmd">/etc/apt/sources.list</span></li>
	
		<code class="cmd">echo 'deb https://download.webmin.com/download/repository sarge contrib' | sudo tee -a /etc/apt/sources.list</code>
	
	<li>Tilføj GPG-nøgle</li>
	
		<code class="cmd">wget http://www.webmin.com/jcameron-key.asc</code>
		
		<code class="more_cmd">sudo apt-key add jcameron-key.asc</code>
	
	<li>Opdatere repositories</li>
	
		<code class="cmd">sudo apt update</code>
	
	<li>Installere Webmin</li>
	
		<code class="cmd">sudo apt-get install apt-transport-https webmin</code>
	
</ul>

<h2>Første start af Webmin</h2>

<p>Læg mærke til følgende i output fra installtionen:</p>

<pre class="black">
Webmin install complete. You can now login to https://NAS:10000/
as root with your root password, or as any user who can use sudo
to run commands as root.
</pre>

<p>Indtast <span class="inl_cmd">https://nas:10000</span> i browseren</p>

<pre class="black">
_
</pre>


<figure id="">

	<img class="p90" src="images/VirtualBox_Ubuntu NAS_67.png" alt="" title="" />

	<figcaption></figcaption>

</figure>

<p>Grunden til at vi bliver advareret er, at browseren ikke kan finde noget certifikat - hvilket vi heller ikke har lavet. Klik på <span class="inl_cmd">AVANCERET</span></p>

<figure id="">

	<img class="p90" src="images/VirtualBox_Ubuntu NAS_68.png" alt="" title="" />

	<figcaption></figcaption>

</figure>

<p>Vælg: <span class="inl_cmd">Fortsæt til 192.168.0.10 (usikkert)</span>. </p>

<figure id="">

	<img class="p60" src="images/VirtualBox_Ubuntu NAS_69.png" alt="" title="" />

	<figcaption></figcaption>

</figure>

<p>Log ind med din almindelige bruger, da han er en del af <span class="inl_cmd">sudo</span>-gruppen:</p>

<figure id="">

	<img class="p90" src="images/VirtualBox_Ubuntu NAS_70.png" alt="" title="" />

	<figcaption></figcaption>

</figure>

<p>Nu er webmin installeret. Vi vil anvende webmin til at administrere vores server herfra:</p>

<h1>SAMBA</h1>

<p>Samba installeres med følgende kommando:</p>

<code class="cmd">sudo apt install samba -y</code>

<h2>Backup</h2>

<p>Er du ikke vant til at arbejde med konfigurationsfiler, så bør du lave en backup af konfigurationsfilen (<span class="inl_cmd">smb.conf</span>). Det gør du med følgende kommando.</p>

	
<code class="cmd">sudo cp /etc/samba/smb.conf /etc/samba/smb.conf.backup</code>
	
<p>Hvis vi senere laver fejl kan vi komme tilbage til udgangspunktet med kommandoen:</p>
	
<code class="cmd">sudo cp /etc/samba/smb.conf.backup /etc/samba/smb.conf</code>


<details>

	<summary>Hvis du mister overblikket</summary>

	<p>Hvis du i løbet af guiden kommer til at lave fejl og har brug for at lave en helt ny installation skal du anvende følgende kommando.</p>

	<code class="cmd">sudo apt purge samba samba-common</code>

	<p>På den måde får du igen de oprindelige konfigurationsfiler. når du geninstallerer.</p>

</details>

<h2>Generel konfiguration</h2>

<p>Indsæt følgende i bunden af filen for at lave den overordnede kjonfiguration:</p>

<code class="cmd">[global]
workgroup = NAS	
server string = Samba Server %v
netbios name = NAS
security = user
map to guest = bad user
dns proxy = no</code>

<p>Workgroup navnet er det navn som din NAS-server bliver genkendt med i resten af systemet.</p>

<p>Genstart SAMBA</p>

<code class="cmd">sudo systemctl restart smbd nmbd</code>

<h2>Sambabrugere</h2>

<p>SAMBA er en tjeneste der kører på Linux og brugere på systemet skal tilføjes til SAMBA, for at de kan anvende tjenestenen. I dette afsnit skal vi lære at:</p>

<ul class="_">
	<li>Tilføje brugere til NAS-serveren</li>
	<li>Tilføje grupper til NAS-serveren</li>
	<li>Tilføje brugere til SAMBA</li>
</ul>

<h3>Tilføj brugere (NAS)</h3>

<p>Brugere tilføjes med følgende kommando:</p>

<code class="cmd">sudo adduser *brugernavn*</code>

<p>Her er et eksempel med forklaringer til:</p>

<pre class="black">tj@nas:~$ sudo adduser test
[sudo] password for tj: <span class="red">&larr; indtast dit root password og tast <kbd>Enter</kbd></span>
Adding user `test' ...
Adding new group `test' (1006) ...
Adding new user `test' (1001) with group `test' ...
Creating home directory `/home/test' ...
Copying files from `/etc/skel' ...
Enter new UNIX password: <span class="red">&larr; indtast ny brugers password og tast <kbd>Enter</kbd></span> 
Retype new UNIX password: <span class="red">&larr; gentag ny brugers password og tast <kbd>Enter</kbd></span>  
passwd: password updated successfully
Changing the user information for test
Enter the new value, or press ENTER for the default
	Full Name []: <span class="red">&larr; Tast <kbd>Enter</kbd></span> 
	Room Number []: <span class="red">&larr; Tast <kbd>Enter</kbd></span> 
	Work Phone []: <span class="red">&larr; Tast <kbd>Enter</kbd></span> 
	Home Phone []: <span class="red">&larr; Tast <kbd>Enter</kbd></span> 
	Other []: <span class="red">&larr; Tast <kbd>Enter</kbd></span> 
Is the information correct? [Y/n] y <span class="red">&larr; Tast <kbd>y</kbd></span> 
</pre>

<h3>Tilføj grupper (NAS)</h3>

<p>Hvis man vil have at flere brugere skal have samme rettigheder til forskellige ressourcer på NAS-serveren sætter man dem sammen i grupper.</p>

<p>Grupper oprettes med følgende kommando:</p>

<code class="cmd">sudo addgroup *gruppenavn*</code>

<p>Brugere tilføjes med kommandown:</p>

<code class="cmd">sudo adduser *brugernavn* *gruppenavn*</code>

<p>Herunder oprettes gruppen <span class="inl_cmd">smbgrp</span> og vil tilføjer vores oprindelige bruger til den (her  tj).</p>

<code class="cmd">sudo adduser tj</code>

<code class="more_cmd">sudo adduser tj smbgrp</code>

<p>Vi kan controllere om brugeren tj er i gruppen ved hjælp af følgende kommando:</p>

<pre class="black">tj@nas:~$ cat /etc/group | grep smbgrp
<span class="red">smbgrp</span>:x:1005:tj <span class="red">&larr; Gruppens brugere står til sidst</span>
</pre>


<h3>Tilføj brugere (SAMBA)</h3>

<p>Sambabrugere administreres seperat fra brugerne på systemet, så de skal tilføjes, hvis man ønsker at ens delinger skal have beskyttet brugeradgang.</p>

<p>Her tilføjer vi brugeren tj (erstat med din bruger)</p>

<code class="cmd">smbpasswd -a tj</code>

<pre class="black">tj@home:/srv$ sudo smbpasswd -a tj
New SMB password:  			<span class="red">&larr; indtast samba-kodeord</span>
Retype new SMB password:	<span class="red">&larr; gentag samba-kodeord</span>
Added user tj.
</pre>

<p>Hvis du senere har brug for at ændre brugerens password bruges samme kommando.</p>

<span class="afsnit">Intet password</span>

<p>Hvis brugeren ikke skal have noget password bruger du kommandoen:</p>

<code class="cmd">smbpasswd -n test</code>

<h2>Dele home på NAS-serveren</h2>

<p>På NAS-serveren har alle brugere en home mappe, og den kan deles ved hjælp af SAMBA ved at indsætte følgende i bunden af <span class="inl_cmd">smb.conf</span></p>

<code class="cmd">[homes]
comment = Bruger mapper   
browseable = yes
read only = no
create mask = 0700
directory mask = 0700
valid users = %S
</code>




<p>Genstart SAMBA</p>

<code class="cmd">sudo systemctl restart smbd nmbd</code>


<h2>Delinger</h2>

<p>Her vil vi oprette to typer delinger. Delinger der er åben for alle og delinger der er brugerbegrænsede.</p>

<table class="centreret">
	<thead>
		<tr>
			<th>Mappe</th>
			<th>Ejer</th>
			<th>Gruppe</th>
			<th>Alle</th>
			<th>Beskrivelse</th>
			<th>Placering</th>
		</tr>
	</thead>
	<tbody>
		<tr>
			<td>Fælles</td>
			<td>Læse/skrive</td>
			<td>Læse/skrive</td>
			<td>Læse/skrive</td>
			<td>Til forefaldende filer</td>
			<td><span class="inl_cmd">/srv/fælles</span></td>
		</tr>
		<tr>
			<td>Media</td>
			<td>Læse/skrive</td>
			<td>Læse</td>
			<td>Læse</td>
			<td>Til musik, billeder og film</td>
			<td><span class="inl_cmd">/srv/media</span></td>
		</tr>
		<tr>
			<td>System</td>
			<td>Læse/skrive</td>
			<td>Læse/skrive</td>
			<td>-</td>
			<td>Systembackup osv</td>
			<td><span class="inl_cmd">/srv/system</span></td>
		</tr>
		<tr>
			<td>Privat</td>
			<td>Læse/skrive</td>
			<td>-</td>
			<td>-</td>
			<td>Private filer</td>
			<td><span class="inl_cmd">/srv/privat</span></td>
		</tr>
	</tbody>
</table>

<p>Læg mærke til at jeg har givet min egen bruger (<span class="inl_cmd">tj</span>) sin egen mappe. Den skal erstattes med dit brugernavn.</p>

<blockquote>
	
	<p>Her er der vist nogle forskellige setups, men i praksis vil 
		
	</p>
</blockquote>

<h3>Opret mapper</h3>

<code class="cmd">sudo mkdir -p /srv/media /srv/backup /srv/tj</code>

<h3>Sæt rettigheder</h3>

<p>Sæt rettigheder på fælles</p>

<code class="cmd">sudo chown -R nobody:nogroup /srv/fælles</code>

<code class="more_cmd">sudo chmod -R 775 /srv/fælles</code>


<p>Sæt rettigheder på media</p>

<code class="cmd">sudo chown -R root:nogroup /srv/media</code>

<code class="more_cmd">sudo chmod -R 755 /srv/media</code>

<p>Sæt rettigheder på system</p>

<code class="cmd">sudo chown -R root:smbgrp /srv/system</code>

<code class="more_cmd">sudo chmod -R 775 /srv/system</code>



<p>Sæt rettigheder på tj</p>

<code class="cmd">sudo chown -R tj:tj /srv/tj</code>

<code class="more_cmd">sudo chmod -R 700 /srv/tj</code>


<p>Vi kontrollerer at alt er sat korrekt op</p>

<pre class="black">tj@home:/srv$ ls -al /srv
total 36
drwxr-xr-x  6 root   root     4096 May  5 14:36 .
drwxr-xr-x 23 root   root     4096 May  5 13:11 ..
drwxr-xr-x  2 nobody nogroup  4096 May  5 15:15 fælles
drwx------  2 root   root    16384 May  5 11:22 lost+found
drwxr-xr-x  2 nobody nogroup  4096 May  5 14:21 media
drwxr-xr-x  2 root   smbgrp   4096 May  5 14:36 system
drwxr-xr-x  2 tj     tj       4096 May  5 14:21 tj
</pre>





<h3>Konfigurer delinger</h3>

<p>Jeg har i denne guide valgt 4 grundlæggende delingsformer, som er praktiske at kende til på en NAS. Brugere kan oprettes ved hjælp af deres home mappe i systemet, men det vil kræve ekstra administration.</p>

<p>De er sat op på følgende måde:</p>

<table class="_">
	<thead>
		<tr>
			<th>Fælles (Alle)</th>
			<th>Media (Alle)</th>
			<th>System (Gruppe)</th>
			<th>Privat</th>
		</tr>
	</thead>
	<tbody>
		<tr>
			<td>Alle har skrive/læse adgang</td>
			<td>Alle har læse adgang</td>
			<td>Gruppe har skrive/læse adgang</td>
			<td>Bruger har skrive/læse adgang</td>
		</tr>
	</tbody>
</table>


<span class="afsnit">Konfigurer Fælles</span>

<p>Denne mappe skal være tilgængelig for alle på nettet uden kodeord.</p>

<code class="cmd">[fælles]
path = /srv/fælles
browsable =yes
writable = yes
guest ok = yes
read only = no
public = yes
force user = nobody</code>

<span class="afsnit">Konfigurer Media</span>

<code class="cmd">[media]
path = /srv/media
browsable =yes
writable = yes
guest ok = yes
read only = no
public = yes
force user = nobody
</code>

<span class="afsnit">Konfigurer System</span>

<code class="cmd">[system]
path = /srv/system
browsable =yes
writable = yes
guest ok = no
read only = no
</code>

<span class="afsnit">Konfigurer bruger</span>

<code class="cmd">[privat]
path = /srv/privat
browsable =yes
writable = yes
guest ok = no
read only = no</code>

<h3>Genstart Samba</h3>

<code class="cmd">sudo systemctl restart smbd nmbd</code>

<h1>Flere brugere</h1>

<p>Hvis man ønsker flere brugere der skal anvende NAS'en</p>


<!--
<h1>FTP</h1>

<h1>Owncloud</h1>
-->





</div><!-- end: col-md-9 -->

<footer>

	<p onclick="parentNode.remove()"><a rel="license" href="http://creativecommons.org/licenses/by-nc-sa/4.0/"><img alt="Creative Commons licens" src="https://i.creativecommons.org/l/by-nc-sa/4.0/88x31.png" /></a>Indholdet på Vidas.dk er  er licenseret under <a rel="license" href="http://creativecommons.org/licenses/by-nc-sa/4.0/">CC BY-NC-SA 4.0</a> og er skrevet af Thomas Jensen. (<a href="../hvem_er_jeg.html" target="_blank">Læs mere</a>)</p>

</footer>
	
	
</div><!-- end: row-fluid -->

</div> <!-- end: container-fluid -->


<!-- SCRIPT SECTION -->
<script type="text/javascript" src="../js/jquery.min.js"></script>
<script type="text/javascript" src="../js/jquery-ui.min.js"></script>
<script type="text/javascript" src="../js/jquery.tocify.min.js"></script>
<script type="text/javascript" src="../js/bootstrap.min.js"></script>

<!-- PRETTYFY-->
<script src="https://cdn.rawgit.com/google/code-prettify/master/loader/run_prettify.js"></script>


<!-- HIGHLIGHT -->
	<script src="../js/highlight.pack.js" type="text/javascript"></script>
	<script>hljs.initHighlightingOnLoad();</script>

<!-- MATHJAX -->
<script type="text/javascript" 
	src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-MML-AM_CHTML">
</script>

<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  displayAlign: "left",
  displayIndent: "0em"
});
</script>


<!-- TOCIFY -->
<script>
	$(function() {var toc = $("#toc").tocify({ selectors: "h1, h2, h3, h4" }).data("toc-tocify"); });
</script>
<!-- GOOGLE ANALYTICS -->
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-89933285-1', 'auto');
  ga('send', 'pageview');
</script>

</body>
</html>
