<!DOCTYPE html>

<head>
	
	<meta charset="UTF-8" lang="da"/>

	<title>Avanceret harddisk opsætning - Thomas Jensen</title>

	<link rel="stylesheet" href="../css/styles/docco.css" />

	<link rel="stylesheet" href="../css/style.css" />

	<link href='http://fonts.googleapis.com/css?family=Ubuntu+Mono|Ubuntu|Ubuntu+Condensed' rel='stylesheet' type='text/css'>
	
	<script src="../js/toc2.js" type="text/javascript"></script>
	<script src="https://code.jquery.com/jquery-2.2.2.js"></script>
	<script src="../js/highlight.pack.js" type="text/javascript"></script>
	<script>hljs.initHighlightingOnLoad();</script>
</head>

<!-- 

code highlighter : https://highlightjs.org/

code converter : http://www.freebits.co.uk/convert-html-code-to-text.html 

-->

<html>

<body onload="generateTOC(document.getElementById('toc'));">

<footer id="license"></footer>

	<script> $( "#license" ).load( "license.html" ); </script>

	<div id="toc">
	<p>Indholdsfortegnelse</p>
	
	</div>
	

<div class="title">Ubuntu server - Avanceret harddisk opsætning med LVM</div>
	
<h1>Avanceret opsætning af harddiske</h1>

<p>I dette afsnit vil vi sætte 2 harddiske op ved hjælp af LVM (<span class="bold">L</span>ogical <span class="bold">V</span>olume <span class="bold">M</span>anagement).</p>

<p>Ideen med LVM er, at man laver nogle virtuelle partitioner, der spænder over en eller flere fysiske harddiske. Det betyder, at man ikke er bundet af størrelsen af de fysiske harddiske og at man løbende kan ændre størrelsen på sine virtuelle partitioner. Man kan f.eks. sætte en ny harddisk i sit system og så udvide sine eksisterende partitioner. Man behøver altså ikke få et nyt monteringspunkt. Man kan også flytte sine virtuelle partitioner fra en fysisk disk, så den kan fjernes/udskiftes. Man kan også tage backup af partitioner mens systemet kører</p>

<p>Med den rette hardware, vil man altså kunne udskifte harddiske og tage backup på et kørende system.</p>


<p> Herunder er en illustration der viser de tre begreber der anvendes i LVM.</p>

<figure id="">

	<img src="images/server_install_16.04_hd_LVM.svg" alt="" title="" />

	<figcaption></figcaption>

</figure>

<p>Her vil vi lave følgende opsætning ved hjælp af LVM.</p>

<table class="">
	<thead>
		<tr>
			<th>Harddiske <br/>Physical Volumes - PV</th>
			<th>LVM - gruppe <br/>Volume Groups - VG</th>
			<th>Logiske grupper <br/>Logical Volumes - LV</th>
			<th>Størrelse</th>
			<th>Monteringspunkt</th>
			<th>Beskrivelse</th>
		</tr>
	</thead>
	<tbody>
		<tr>
			<td rowspan="3"><br/><br/><span class="inl_cmd">/dev/sda</span>  (100GB)</td>
			<td rowspan="6">arkiv01</td>
			<td>system</td>
			<td>10 GB</td>
			<td><span class="inl_cmd">/</span></td>
			<td>System</td>
		</tr>
		<tr>
			<td>server</td>
			<td>120 GB</td>
			<td><span class="inl_cmd">/srv</span></td>
			<td>Ressourcer til netværket</td>
		</tr>
		<tr>
			<td>data</td>
			<td>30 GB</td>
			<td><span class="inl_cmd">/data</span></td>
			<td>backup og dokumentation</td>
		</tr>
		<tr>
			<td rowspan="3"><br/><br/><span class="inl_cmd">/dev/sdb</span> (100GB)</td>			
			<td>web</td>
			<td>8 GB</td>
			<td><span class="inl_cmd">/var/www</span></td>
			<td>Placering af hjemmeside</td>
		</tr>
		<tr>
			<td>swap</td>
			<td>1 GB</td>
			<td><span class="inl_cmd">swap</span></td>
			<td>swap drev</td>
		</tr>
		<tr>
			<td>-</td>
			<td>31 GB</td>
			<td>-</td>
			<td>FRI</td>
		</tr>

	</tbody>
</table>


<p>Det vi skal gøre er:</p>

<ol class="">
	<li>Klargøre harddiskene</li>
	<li>Lave en VG (Volume group) af vores to harddiske - <span class="bold">arkiv01</span></li>
	<li>Oprette de 6 LG'er (Logical Volumes)</li>
	<li>Montere de 6 LG'er</li>
</ol>

<p>Vælg <span class="terminal_valg2">Manuelt</span> som partitioneringsmetode</p>

<figure id="">

	<img src="images/server_install_hd_01.png" alt="" title="" />

	<figcaption></figcaption>

</figure>

<h1>Klargøring af harddiske</h1>

<p>Hvis du installerer i VirtualBox som jeg gør, eller har helt nye harddiske i, skal der først oprettes partitionstabeller på harddiskene. Ubunt vil selv gøre opmærksom på det, hvis den ikke er oprettet. Vælg den første disk og tryk <kbd>Enter</kbd>.</p>

<figure id="">

	<img src="images/server_install_hd_02.png" alt="" title="" />

	<figcaption></figcaption>

</figure>

<p>Vælg: <span class="terminal_valg">ja</span>, for at oprette partitionstabellen.</p>

<figure id="">

	<img src="images/server_install_hd_03.png" alt="" title="" />

	<figcaption></figcaption>

</figure>

<p>Her kan du se, at der under den første harddisk nu står <span class="inl_cmd">pri/log   107.4 GB  ....</span>.</p>

<figure id="">

	<img src="images/server_install_hd_04.png" alt="" title="" />

	<figcaption></figcaption>

</figure>

<p>Gør det samme ved den anden harddisk.</p>

<h1>Opsæt LVM</h1>

<p>Vælg <span class="terminal_valg2">Opsætning af den logiske diskenhedshåndtering (LVM)</span> </p>

<figure id="">

	<img src="images/server_install_hd_06.png" alt="" title="" />

	<figcaption></figcaption>

</figure>

<p>Før Vi kan sætte LVM op, skal de ændringer vi lavede før skrives til disken. Dette vil slette alt indhold der har været på diskene. Vælg <span class="terminal_valg">Ja</span>:</p>

<figure id="">

	<img src="images/server_install_hd_07.png" alt="" title="" />

	<figcaption></figcaption>

</figure>

<h1>Opret en VG - Volume Group</h1>

<p>Her skal vi oprette vores VG, som kaldes en diskenhedsgruppe på dansk. Jeg har valgt at bibeholde de engelske betegnelser i denne guide, da det er betegnelserne man skal anvende når man kigger i dokumentation og anvender kommandoer senere. Vælg: <span class="terminal_valg2">Opret diskenhedsgruppe</span></p>

<figure id="">

	<img src="images/server_install_hd_08.png" alt="" title="" />

	<figcaption></figcaption>

</figure>

<p>Giv den navnet:<span class="inl_cmd">arkiv01</span> og vælg <span class="terminal_valg">Fortsæt</span>.</p>

<figure id="">

	<img src="images/server_install_hd_09.png" alt="" title="" />

	<figcaption></figcaption>

</figure>

<p>Tilføj dine harddiske ved ved hjælp af at markere begge harddiske med en stjerne ved at trykke på <kbd>Mellemrum</kbd>. Efter begge er valgt tryk <span class="terminal_valg">Fortsæt</span>.</p>

<figure id="">

	<img src="images/server_install_hd_10.png" alt="" title="" />

	<figcaption></figcaption>

</figure>

<p>Herefter skal ændringerne endnu engang skrives til diskene. Vælg <span class="terminal_valg">Ja</span>.</p>

<figure id="">

	<img src="images/server_install_hd_11.png" alt="" title="" />

	<figcaption></figcaption>

</figure>

<h1>Opret LG'er - Logical Volumes</h1>

<p>Her skal vi oprette de 5 logiske enheder (partitioner), som skal udgøre opdelingen af vores system: system, serverdata, data, web og swap.</p>

<table class="">
	<thead>
		<tr>
			<th>Harddiske <br/>Physical Volumes - PV</th>
			<th>LVM - gruppe <br/>Volume Groups - VG</th>
			<th>Logiske grupper <br/>Logical Volumes - LV</th>
			<th>Størrelse</th>
			<th>Monteringspunkt</th>
			<th>Beskrivelse</th>
		</tr>
	</thead>
	<tbody>
		<tr>
			<td rowspan="5"><span class="inl_cmd">/dev/sda</span> <br/><br/><span class="inl_cmd">/dev/sdb</span></td>
			<td rowspan="5">arkiv01</td>
			<td>system</td>
			<td>10 GB</td>
			<td><span class="inl_cmd">/</span></td>
			<td>System</td>
		</tr>
		<tr>
			<td>server</td>
			<td>120 GB</td>
			<td><span class="inl_cmd">/srv</span></td>
			<td>Ressourcer til netværket</td>
		</tr>
		<tr>
			<td>data</td>
			<td>30 GB</td>
			<td><span class="inl_cmd">/data</span></td>
			<td>backup og dokumentation</td>
		</tr>
		<tr>
			<td>web</td>
			<td>8 GB</td>
			<td><span class="inl_cmd">/var/www</span></td>
			<td>Placering af hjemmeside</td>
		</tr>
		<tr>
			<td>swap</td>
			<td>1 GB</td>
			<td><span class="inl_cmd">swap</span></td>
			<td>swap drev</td>
		</tr>

	</tbody>
</table>

<p>Vælg <span class="terminal_valg2">Opret logisk diskenhed</span>.</p>

<figure id="">

	<img src="images/server_install_hd_12.png" alt="" title="" />

	<figcaption></figcaption>

</figure>

<p>Vælg <span class="terminal_valg2">arkiv01</span>.</p>

<figure id="">

	<img src="images/server_install_hd_13.png" alt="" title="" />

	<figcaption></figcaption>

</figure>

<p>Angiv navnet på LG'en, hvor den første her er <span class="inl_cmd">system</span> og vælg <span class="terminal_valg">Fortsæt</span>.</p>

<figure id="">

	<img src="images/server_install_hd_14.png" alt="" title="" />

	<figcaption></figcaption>

</figure>

<p>Sæt størrelsen, her <span class="inl_cmd">10G</span> (10 GigaByte) og vælg <span class="terminal_valg">Fortsæt</span></p>

<figure id="">

	<img src="images/server_install_hd_15.png" alt="" title="" />

	<figcaption></figcaption>

</figure>

<p>Her vil vi lige tjekke vores opsætning. Vælg <span class="terminal_valg2">Vis opsætningsdetaljer</span>.</p>

<figure id="">

	<img src="images/server_install_hd_16.png" alt="" title="" />

	<figcaption></figcaption>

</figure>

<p>Her får vi et overblik over:</p>

<ul class="disc">
	<li>Ikke anvende fysiske harddiske</li>
	<li>Tilgængelige Volume groups (Diskenhedsgrupper) og deres fysiske enheder</li>
	<li>Tilgængelige Logical Volumes (Logiske diskenheder)</li>
</ul>

<figure id="">

	<img src="images/server_install_hd_17.png" alt="" title="" />

	<figcaption></figcaption>

</figure>

<p>Fortsæt med at oprette resten: <span class="inl_cmd">server, data, wab, swap</span> og tjek at du har gjort det korrekt ved at anvende <span class="terminal_valg2">Vis opsætningsdetaljer</span>.</p>

<figure id="">

	<img src="images/server_install_hd_35.png" alt="" title="" />

	<figcaption></figcaption>

</figure>

<p>Afslut herefter opsætningen af LVM ved at vælge <span class="terminal_valg2">Afslut</span>.</p>

<figure id="">

	<img src="images/server_install_hd_36.png" alt="" title="" />

	<figcaption></figcaption>

</figure>

<h1>Afslut opsætningen af harddiskene</h1>

<p>Efter at du har sat LVM op, kommer du tilbage til hovedmenuen. Som du kan se er dine LG'er tilføjet til oversigten. Læg mærke til at de er tilføjet i alfabetisk orden alt efter din navngivning. Dem skal vi nu ind og vælge enkeltvis, for at vi kan konfigurere de sidste detaljer. Vælg det første arkiv som er <span class="inl_cmd">data</span>.</p>

<figure id="">

	<img src="images/server_install_hd_37.png" alt="" title="" />

	<figcaption></figcaption>

</figure>

<p>Herefter kommer du ind i følgende menu, hvor du kan se at den er slået fra som standard. Vælg <span class="terminal_valg2">Brug som: brug ikke</span>, da den vi føre dig igennem opsætningen:</p>

<figure id="">

	<img src="images/server_install_hd_38.png" alt="" title="" />

	<figcaption></figcaption>

</figure>

<p>Det første du skal vælge er filsystemet. Vælg <span class="terminal_valg2">Ext4-journalfilsystem</span></p>

<figure id="">

	<img src="images/server_install_hd_39.png" alt="" title="" />

	<figcaption></figcaption>

</figure>

<p>Herefter skal monteringspunktet opsættes. Vælg: <span class="terminal_valg2">Angiv manuelt</span>, da den mappe vi vil montere <span class="inl_cmd">data</span> i ikke er en del af standardfilsystemet.</p>

<figure id="">

	<img src="images/server_install_hd_40.png" alt="" title="" />

	<figcaption></figcaption>

</figure>

<p>Indtast herefter monteringspunktet <span class="inl_cmd">/data</span> og vælg <span class="terminal_valg">Fortsæt</span>.</p>

<figure id="">

	<img src="images/server_install_hd_41.png" alt="" title="" />

	<figcaption></figcaption>

</figure>

<p>Herefter kommer et overblik over det du har gjort. Tjek at det er korrekt og vælg: <span class="terminal_valg2">Færdig med at sætte partitionen op</span>.</p>

<figure id="">

	<img src="images/server_install_hd_42.png" alt="" title="" />

	<figcaption></figcaption>

</figure>

<p>Sæt herefter de resterende partitioner (<span class="inl_cmd">server, data, wab, swap</span>) op på samme måde. Vær opmærksom på at <span class="inl_cmd">swap</span> partitionen skal sættes op lidt anederledes. I stedet for at vælge <span class="inl_cmd">Ext4</span> skal du vælge: <span class="terminal_valg2">swapområde</span>, og den skal ikke monteres på filsystemet.</p>

<figure id="">

	<img src="images/server_install_hd_51.png" alt="" title="" />

	<figcaption></figcaption>

</figure>

<p>Efter at du har sat alle partitionerne op bør du kontrollere at du har sat det hele op korrekt. Herefter vælges <span class="terminal_valg2">Afslut partitioneringen og skriv ændringerne til disken</span>.</p>

<figure id="">

	<img src="images/server_install_hd_52.png" alt="" title="" />

	<figcaption></figcaption>

</figure>

<p>Du får igen et sidste overblik over din opsætning. Kontroller at det er sat korrekt op og vælg <span class="terminal_valg">Ja</span></p>

<figure id="">

	<img src="images/server_install_hd_53.png" alt="" title="" />

	<figcaption></figcaption>

</figure>

<p>Du kan nu fortsætte ubuntu server installationsguiden: <a href="server_install_16.06.LTS.html#after_hd_konfiguration" target="_blank">server_install_16.06.LTS.html</a></p>

<p></p>
<p></p>
<p></p>
<p></p>

	</body>

</html>
