<!DOCTYPE html>

<head>
	
	<meta charset="UTF-8" lang="da"/>

	<title>Ubuntu server Installation - Thomas Jensen</title>

	<link rel="stylesheet" href="../css/styles/docco.css" />

	<link rel="stylesheet" href="../css/style.css" />

	<link href='http://fonts.googleapis.com/css?family=Ubuntu+Mono|Ubuntu|Ubuntu+Condensed' rel='stylesheet' type='text/css'>
	
	<script src="../js/toc2.js" type="text/javascript"></script>
	<script src="https://code.jquery.com/jquery-2.2.2.js"></script>
	<script src="../js/highlight.pack.js" type="text/javascript"></script>
	<script>hljs.initHighlightingOnLoad();</script>
</head>

<!-- 

code highlighter : https://highlightjs.org/

code converter : http://www.freebits.co.uk/convert-html-code-to-text.html 

-->

<html>

<body onload="generateTOC(document.getElementById('toc'));">

<footer id="license"></footer>

	<script> $( "#license" ).load( "license.html" ); </script>

	<div id="toc">
	<p>Indholdsfortegnelse</p>
	
	</div>
	

<div class="title">Ubuntu server - Simpel opsætning</div>
	
<h1>Denne guide</h1>

<p>I denne guide lærer du at sætte en basal "headless" Ubuntu-server op med en enkelt harddisk. Headless i denne sammenhæng betyder, at du kan fjerne tastetur og mus efter installationen og tilgå serveren over netværk ved hjælp af SSH</p>

<p>Jeg har valgt ikke at kommentere hvert eneste skærmbillede, da langt de fleste af dem giver sig selv. Der er kommentarer hvor det er nødvendigt, eller hvor du som bruger skal foretage dig et aktivt valg.</p>

<h2>Hardware</h2>

<p>I denne guide har jeg oprettet en virtuel maskine i VirtualBox, med nedestående parametre:</p>

<table class="">
	<thead>
		<tr>
			<th></th>
			<th></th>
		</tr>
	</thead>
	<tbody>
		<tr>
			<td>RAM</td>
			<td>1024 MB</td>
		</tr>
		<tr>
			<td>Grafikhukommelse</td>
			<td>12 MB</td>
		</tr>
		<tr>
			<td>Harddiske (simpel)</td>
			<td>1 stk 100GB</td>
		</tr>
		<tr>
			<td>Harddisk (avanceret)</td>
			<td>2 stk 100GB</td>
		</tr>
		<tr>
			<td>Lydkort</td>
			<td>Nej</td>
		</tr>
		<tr>
			<td>Netværk</td>
			<td>Netværksbro, så den virtuelle maskine er koblet på værtens netværk</td>
		</tr>	
	</tbody>
</table>

<h2>Netværket</h2>

<p>Serveren er sat i et netværk med følgende parametre:</p>

<table class="">
	<thead>
		<tr>
			<th></th>
			<th></th>
		</tr>
	</thead>
	<tbody>
		<tr>
			<td>Netværk</td>
			<td>192.168.0.0</td>
		</tr>
		<tr>
			<td>Netmaske</td>
			<td>255.255.255.0 (CIDR /24)</td>
		</tr>
		<tr>
			<td>Gateway</td>
			<td>192.168.0.1</td>
		</tr>
		<tr>
			<td>DNS</td>
			<td>8.8.8.8 8.8.4.4 (Googles DNS)</td>
		</tr>
		<tr>
			<td>DHCP-scope</td>
			<td>192.168.0.50 - 192.168.0.200 
			<br/>
			<br/>
			På den måde er der plads til 47 statiske IPadresser</td>
		</tr>
		<tr>
			<td>Domain name</td>
			<td>home.local</td>
		</tr>
	</tbody>
</table>

<p>For serveren gælder der følgende:</p>

<table class="">
	<thead>
		<tr>
			<th></th>
			<th></th>
		</tr>
	</thead>
	<tbody>
		<tr>
			<td>Server IP</td>
			<td>192.168.0.10</td>
		</tr>
		<tr>
			<td>Netmaske</td>
			<td>255.255.255.0 (CIDR /24)</td>
		</tr>
		<tr>
			<td>Gateway</td>
			<td>192.168.0.1</td>
		</tr>
		<tr>
			<td>DNS</td>
			<td>8.8.8.8 8.8.4.4 (Googles DNS)</td>
		</tr>
		<tr>
			<td>FQDN</td>
			<td>mainsrv.home.local</td>
		</tr>
	</tbody>
</table>

<h2>Harddisk opsætning</h2>

<p>Der vil i denne guide være to muligheder for opsætning af harddiske. De er beskrevet her:</p>

<span class="afsnit">Simpel setup</span>

<p>I dette setup vil der være en harddisk (100GB), og vi vil lade installationen partitionere harddisken for os.</p>

<p>Ubuntu vil lave en logisk swap-partition på størrelse med RAM og resten vil blive anvendt til en primær systempartition (<span class="inl_cmd">/</span>). I dette tilfælde</p>

<table class="">
	<thead>
		<tr>
			<th></th>
			<th></th>
		</tr>
	</thead>
	<tbody>
		<tr>
			<td><span class="inl_cmd">/</span></td>
			<td>99 GB</td>
		</tr>
		<tr>
			<td><span class="inl_cmd">swap</span></td>
			<td>1 GB</td>
		</tr>
	</tbody>
</table>

<span class="afsnit">Avanceret setup</span>

<p>I dette setup vil der blive anvendt 2 harddiske (2 stk. 100GB). Harddiskene vil blive sat op ved hjælp af LVM. Se nedenstående skema:</p>

<table class="">
	<thead>
		<tr>
			<th>Harddiske <br/>Physical Volumes - PV</th>
			<th>LVM - gruppe <br/>Volume Groups - VG</th>
			<th>Logiske grupper <br/>Logical Volumes - LV</th>
			<th>Størrelse</th>
			<th>Monteringspunkt</th>
			<th>Beskrivelse</th>
		</tr>
	</thead>
	<tbody>
		<tr>
			<td rowspan="5"><span class="inl_cmd">/dev/sda</span> <br/><br/><span class="inl_cmd">/dev/sdb</span></td>
			<td rowspan="5">arkiv01</td>
			<td>system</td>
			<td>10 GB</td>
			<td><span class="inl_cmd">/</span></td>
			<td>System</td>
		</tr>
		<tr>
			<td>server</td>
			<td>120 GB</td>
			<td><span class="inl_cmd">/srv</span></td>
			<td>Ressourcer til netværket</td>
		</tr>
		<tr>
			<td>data</td>
			<td>30 GB</td>
			<td><span class="inl_cmd">/data</span></td>
			<td>backup og dokumentation</td>
		</tr>
		<tr>
			<td>web</td>
			<td>8 GB</td>
			<td><span class="inl_cmd">/var/www</span></td>
			<td>Placering af hjemmeside</td>
		</tr>
		<tr>
			<td>swap</td>
			<td>1 GB</td>
			<td><span class="inl_cmd">swap</span></td>
			<td>swap drev</td>
		</tr>

	</tbody>
</table>

<h2>Anvend tasteturet</h2>

<p>Under installationen af Ubuntu serveren skal du anvende tasteturet. I starten er det lidt underligt at navigere ved hjælp af tasteturet, men det hurtigt og effektivt. Navigationen fungerer efter følgende skema:</p>

<table class="">
	<thead>
		<tr>
			<th>Tast</th>
			<th>Funktion</th>
		</tr>
	</thead>
	<tbody>
		<tr>
			<td><kbd>Tab</kbd></td>
			<td>Hopper mellem de forskellige punkter i installationsmenuen.</td>
		</tr>
		<tr>
			<td><kbd>Mellemrum</kbd></td>
			<td>Vælger.</td>
		</tr>
		<tr>
			<td><kbd>Enter</kbd></td>
			<td>Udfører. Ved flere menuer vil <kbd>Enter</kbd> gøre sådan at du blot accepterer der der står i installationsmenuen.</td>
		</tr>
		<tr>
			<td><kbd>&larr;</kbd>, <kbd>&rarr;</kbd>, <kbd>&uarr;</kbd>, <kbd>&darr;</kbd></td>
			<td>Kan i nogle tilfælde anvendes til at vælge med.</td>
		</tr>
	</tbody>
</table>

<p>Ved langt de fleste installationsmenuer står informationerne også i bunden:</p>

<figure id="">

	<img src="images/server_install_16.04_00a.png" alt="" title="" />

	<figcaption></figcaption>

</figure>



<h2>Ved fejlvalg</h2>

<p>Hvis du laver en fejl kan du altid gå tilbage i installtionsmetoden ved at vælge <span class="terminal_valg">Gå tilbage</span> og derefter vælge punktet hvor det gik galt. Har du lavet indtastninger husker installationen på det, så du kan nøjes med at ændre de ting der er fejl i.</p>

<figure id="">

	<img src="images/server_install_16.04_00.png" alt="" title="" />

	<figcaption></figcaption>

</figure>

	
<h1>Begynd installationen</h1>

<p>Før selve installationen starter skal du vælge sprog. Herunder kommer der skærmdumps fra installationen</p>

<p>Vælg <span class="inl_cmd">dansk</span></p>

<figure id="">

	<img src="images/server_install_16.04_01.png" alt="" title="" />

	<figcaption></figcaption>

</figure>

<p>Vælg den første mulighed: Installér Ubuntu Server</p>

<figure id="">

	<img src="images/server_install_16.04_02.png" alt="" title="" />

	<figcaption></figcaption>

</figure>

<p>Forsæt installationen på Dansk. Vælg: <span class="terminal_valg">Ja</span> og derefter "Danmark".</p>

<figure id="">

	<img src="images/server_install_16.04_03.png" alt="" title="" />

	<figcaption></figcaption>

</figure>



<figure id="">

	<img src="images/server_install_16.04_04.png" alt="" title="" />

	<figcaption></figcaption>

</figure>

<span class="afsnit">Tastetur</span>

<p>Efter du har valgt sprog skal du vælge dit tastetur. Vælg <span class="terminal_valg">Nej</span>, for at du selv kan vælge dit tastetur.</p>

<figure id="">

	<img src="images/server_install_16.04_05.png" alt="" title="" />

	<figcaption></figcaption>

</figure>

<figure id="">

	<img src="images/server_install_16.04_06a.png" alt="" title="" />

	<figcaption></figcaption>

</figure>

<figure id="">

	<img src="images/server_install_16.04_06.png" alt="" title="" />

	<figcaption></figcaption>

</figure>

<p>Herefter installeres nogle filer:</p>

<figure id="">

	<img src="images/server_install_16.04_06b.png" alt="" title="" />

	<figcaption></figcaption>

</figure>



<h1>Netværk</h1>

<p>Netværksopsætningen kan være lidt tricky. Det skyldes at serveren automatisk vil forsøge at finde en DHCP-server så den automatisk får en IP-adresse. Denne funktion vil normalt ligge i den router du har stående. Vi vil have at den får en fast IP, nemlig <span class="inl_cmd">10.0.2.10</span>.</p>

<p>Den nedestående fejlmeddelelse kommer hvis du ikke har nogen DHCP-server på netværket. Vælg: <span class="terminal_valg">Fortsæt</span>.</p>

<figure id="">

	<img src="images/server_install_16.04_07.png" alt="" title="" />

	<figcaption></figcaption>

</figure>

<p> Hvis du har en DHCP-server på netværket vil Ubuntu selv sætte netværket op, og du ender med nedestående vindue <span class="inl_cmd">"Angiv dette systems værtsnavn"</span>. Her skal du ikke vælge <span class="inl_cmd">Fortsæt</span>, men vælge <span class="terminal_valg">Gå tilbage</span>, for at kunne konfigurere netværket selv.</p>

<figure id="">

	<img src="images/server_install_16.04_07a.png" alt="" title="" />

	<figcaption></figcaption>

</figure>

<h2>Manuel opsætning af netværk</h2>

<p>I vinduet "Sæt netværket op" skal du vælge <span class="terminal_valg2">Sæt netværket op manuelt</span>.</p>

<figure id="">

	<img src="images/server_install_16.04_08.png" alt="" title="" />

	<figcaption></figcaption>

</figure>

<p>Herefter skal du indtaste netværkets oplysninger. I denne opgave er de:</p>

<table class="">
	<thead>
		<tr>
			<th></th>
			<th></th>
		</tr>
	</thead>
	<tbody>
		<tr>
			<td>Server IP</td>
			<td>192.168.0.10/24</td>
		</tr>
		<tr>
			<td>Gateway</td>
			<td>192.168.0.1</td>
		</tr>
		<tr>
			<td>DNS</td>
			<td>8.8.8.8 8.8.4.4 (Googles DNS)</td>
		</tr>
		<tr>
			<td>Værtsnavn</td>
			<td>mainsrv</td>
		</tr>
		<tr>
			<td>Domænenavn</td>
			<td>home.local</td>
		</tr>
	</tbody>
</table>

<p>Når du har indtastet netværksinformationerne taster du blot <kbd>Enter</kbd>, så bliver <span class="terminal_valg">Fortsæt</span> automatisk valgt.</p>

<figure id="">

	<img src="images/server_install_16.04_09.png" alt="" title="" />

	<figcaption></figcaption>

</figure>

<figure id="">

	<img src="images/server_install_16.04_10.png" alt="" title="" />

	<figcaption></figcaption>

</figure>

<figure id="">

	<img src="images/server_install_16.04_11.png" alt="" title="" />

	<figcaption></figcaption>

</figure>

<figure id="">

	<img src="images/server_install_16.04_12.png" alt="" title="" />

	<figcaption></figcaption>

</figure>

<figure id="">

	<img src="images/server_install_16.04_13.png" alt="" title="" />

	<figcaption></figcaption>

</figure>

<h1>Brugeropsætning</h1>

<p>Den første bruger man opretter på et Ubuntu-system er automatisk <span class="inl_cmd">sudo</span> bruger. Derfor er det vigtigt at du husker brugernavn og password. Er det kun til test du opretter serveren vil jeg anbefale at du anvender dine initialer og <span class="inl_cmd">123qwe</span> som adgangskode. Læg mærke til at Ubuntu advarer dig om at det er svagt password, hvis det ikke indeholder nok tegn eller en god blandning af bogstaver, tal, tegn og symboler.</p>

<p>Angiv først brugerens fulde navn og herefter brugernavn på computeren:</p>

<figure id="">

	<img src="images/server_install_16.04_14.png" alt="" title="" />

	<figcaption></figcaption>

</figure>

<figure id="">

	<img src="images/server_install_16.04_15.png" alt="" title="" />

	<figcaption></figcaption>

</figure>

<p>Angiv adgangskode:</p>

<figure id="">

	<img src="images/server_install_16.04_16.png" alt="" title="" />

	<figcaption></figcaption>

</figure>

<figure id="">

	<img src="images/server_install_16.04_17.png" alt="" title="" />

	<figcaption></figcaption>

</figure>

<p>Hvis du ligesom mig har valgt et meget simpelt password (Her har jeg valgt <span class="inl_cmd">123qwe) </span>vil installationen advare dig så du kan ændre det. Er det til testformål er det ikke vigtigt, men skal den f.eks. bruges som webserver, bør du have en adgangskode der indeholder minimum 10 tegn, og hvor det er en blanding store og små bogstaver, tal og tegn.</p>

<figure id="">

	<img src="images/server_install_16.04_18.png" alt="" title="" />

	<figcaption></figcaption>

</figure>

<p>Du kan vælge at kryptere dit hjemmekatalog. Jeg vælger som regel <span class="terminal_valg">Nej</span></p>

<figure id="">

	<img src="images/server_install_16.04_19.png" alt="" title="" />

	<figcaption></figcaption>

</figure>

<p>Vælg herefter tidszone:</p>

<figure id="">

	<img src="images/server_install_16.04_20.png" alt="" title="" />

	<figcaption></figcaption>

</figure>

<h1>Opsætning af harddisk</h1>

<p>Herunder får du mulighed for at vælge to forskellige harddiskkonfigurationer.</p>

<table class="">
	<thead>
		<tr>
			<th>Opsætning</th>
			<th>Beskrivelse</th>
			<th>Anbefales til</th>
		</tr>
	</thead>
	<tbody>
		<tr>
			<td>Simpel</td>
			<td>Her vil vi lade installationen konfigurere harddisken. Der vil blive lavet en mindre <span class="inl_cmd">swap</span>-partition og resten bliver til <span class="inl_cmd">/</span></td>
			<td>Simple backup og server løsninger</td>
		</tr>
		<tr>
			<td>Avanceret</td>
			<td>Harddisken vil blive sat op med LVM, sådan at du senere kan ændre i partitionsstørelser, udskrifte harddiske osv.</td>
			<td>Produktionssystemer, hvor sikkerhed og drift er vigtig</td>
		</tr>
		
	</tbody>
</table>

<h2>Simpel opsætning</h2>

<p></p>

<p>Med denne metode sørger Ubuntu selv for at sætte harddisken op. Det gør den ved at lave 2 partitioner: root (systemdrev) og swap. Swap bliver sat nogenlunde til den samme RAM-mængde som computeren har. Vælg "Guidet - benyt en hel disk" og derefter den disk du vil partitionere.</p>


<figure id="">

	<img src="images/server_install_16.04_21.png" alt="" title="" />

	<figcaption></figcaption>

</figure>



<figure id="">

	<img src="images/server_install_16.04_22.png" alt="" title="" />

	<figcaption></figcaption>

</figure>

<p>Til sidst får du et overblik over de ændringer du har lavet på harddisken og du skal bekræftige at du vil skrive på disken. Svar <span class="terminal_valg">Ja</span>.</p>

<figure id="">

	<img src="images/server_install_16.04_23.png" alt="" title="" />

	<figcaption></figcaption>

</figure>

<h2>Avanceret opsætning</h2>

<p>For at gøre denne guide overskuelig har jeg valgt at lægge den avancerede opsætning i et andet dokument. Heri vil du blive guidet igennem at sætte Ubuntu serveren op med LVM med følgende konfiguration:</p>

<table class="">
	<thead>
		<tr>
			<th>Harddiske <br/>Physical Volumes - PV</th>
			<th>LVM - gruppe <br/>Volume Groups - VG</th>
			<th>Logiske grupper <br/>Logical Volumes - LV</th>
			<th>Størrelse</th>
			<th>Monteringspunkt</th>
			<th>Beskrivelse</th>
		</tr>
	</thead>
	<tbody>
		<tr>
			<td rowspan="3"><br/><br/><br/><span class="inl_cmd">/dev/sda</span>  (100GB)</td>
			<td rowspan="6"><br/><br/><br/><br/><br/><br/><span class="afsnit">Arkiv01</span></td>
			<td>system</td>
			<td>10 GB</td>
			<td><span class="inl_cmd">/</span></td>
			<td>System</td>
		</tr>
		<tr>
			<td>server</td>
			<td>120 GB</td>
			<td><span class="inl_cmd">/srv</span></td>
			<td>Ressourcer til netværket</td>
		</tr>
		<tr>
			<td>data</td>
			<td>30 GB</td>
			<td><span class="inl_cmd">/data</span></td>
			<td>backup og dokumentation</td>
		</tr>
		<tr>
			<td rowspan="3"><br/><br/><span class="inl_cmd">/dev/sdb</span> (100GB)</td>			
			<td>web</td>
			<td>8 GB</td>
			<td><span class="inl_cmd">/var/www</span></td>
			<td>Placering af hjemmeside</td>
		</tr>
		<tr>
			<td>swap</td>
			<td>1 GB</td>
			<td><span class="inl_cmd">swap</span></td>
			<td>swap drev</td>
		</tr>
		<tr>
			<td>-</td>
			<td>31 GB</td>
			<td>-</td>
			<td>FRI</td>
		</tr>

	</tbody>
</table>

<p>Grunden til at der er plads til overs skyldes at denne installation vil blive anvendt i en LVM guide, så der er noget fri plads at eksperiemtere med.</p>

<span id="after_hd_konfiguration"></span>

<p>Find guiden her: <a href="server_avanceret_HD_install_16.06.LTS.html" target="_blank">server_avanceret_HD_install_16.06.LTS.html</a></p>

<h1>HTTP-Proxy og opdateringer</h1>

<p>Hvis du har en HTTP-proxy der skal sættes op ... så har du ikke brug for denne guide. Vælg <span class="inl_cmd">fortsæt</span> uden at skrive noget på linien:</p>

<figure id="">

	<img src="images/server_install_16.04_24.png" alt="" title="" />

	<figcaption></figcaption>

</figure>


<p>Konfigurer hvordan systemet skal opdateres. Hvis du blot ønsker en meget simpel server, du ikke skal have noget arbejde med, kan du roligt vælge: <span class="terminal_valg2">Installer sikkerhedsoplysninger automatisk</span>. Hvis du selv ønsker at have kontrol over opdateringerne vælger du: <span class="terminal_valg2">Ingen automatiske opdateringer</span> (<span class="red">ANBEFALET</span>).</p>

<figure id="">

	<img src="images/server_install_16.04_25.png" alt="" title="" />

	<figcaption></figcaption>

</figure>

<h1>Installer OpenSSH server</h1>

<p></p>

<p>I denne opsætning vælger vi kun at installere det mest basale. <span class="inl_cmd">"Standard system utilities"</span> er valgt som standard, så du skal kun tilføje <span class="inl_cmd">"OpenSSH server"</span>, så du kan få adgang til serveren over netværket. Vælg <span class="terminal_valg">Fortsæt</span>, så installationen fortsætter.</p>


<figure id="">

	<img src="images/server_install_16.04_26.png" alt="" title="" />

	<figcaption></figcaption>

</figure>

<figure id="">

	<img src="images/server_install_16.04_27.png" alt="" title="" />

	<figcaption></figcaption>

</figure>

<h1>Bootloaderen <span class="inl_cmd">GRUB</span></h1>

<p><span class="inl_cmd">GRUB</span> (the <span class="bold">GR</span>and <span class="bold">U</span>nified <span class="bold">B</span>ootloader) sørger for at Ubuntu kan boote. Alt efter om du har valgt <span class="inl_cmd">simpel</span> eller <span class="inl_cmd">avanceret</span> harddiskopsætning, så vil du få et af nedestående vinduer</p>

<h2>Simpel harddisk opsætning</h2>

<p>Vælg at installere GRUB på opstartssporet - tryk <span class="terminal_valg">Ja</span>.</p>

<figure id="">

	<img src="images/server_install_16.04_28.png" alt="" title="" />

	<figcaption></figcaption>

</figure>

<h2>Avanceret harddisk opsætning</h2>

<p>Her kan du vælge hvor du vil have GRUB installeret. Vælg den første harddisk <span class="terminal_valg2">/dev/sda ...</span> og tryk <kbd>Enter</kbd></p>

<figure id="">

	<img src="images/server_install_16.04_28a.png" alt="" title="" />

	<figcaption></figcaption>

</figure>

<p>Herefter er installationen færdig. Tryk <span class="terminal_valg">Fortsæt</span>, fjern bootmediet og nyd din nyinstallerede server:</p>

<figure id="">

	<img src="images/server_install_16.04_29.png" alt="" title="" />

	<figcaption></figcaption>

</figure>

<h1>Første start</h1>

<p>Det første opstartsbillede er GRUB'en</p>

<figure id="">

	<img src="images/server_install_16.04_30.png" alt="" title="" />

	<figcaption></figcaption>

</figure>

<p>Herefter melder Ubuntu sig klar, så du kan logge ind.</p>

<figure id="">

	<img src="images/server_install_16.04_31.png" alt="" title="" />

	<figcaption></figcaption>

</figure>

<p>Første gang du logger på får du informationer om servere. De vigtigste du skal forholde dig til er sektionen med opdateringer.</p>

<figure id="">

	<img src="images/server_install_16.04_32.png" alt="" title="" />

	<figcaption></figcaption>

</figure>

<h2>Opdatering af serveren</h2>

<p>For at opdatere er der 3 ting vi skal have gjort:</p>

<ol class="">
	<li>Ændre repositories fra danske til internationale og tilføjer partner repository</li>
	<li>Opdatere repository filerne</li>
	<li>Opgradere Ubuntu</li>
	<li>Fjerne overflødige kerner (efter kontrolopstart)</li>
</ol>

<p>Ubuntu søger som standard i danske repositories efter filer. Det er min erfaring at disse er langsommere at tilgå og hente fra end de internationale. Derfor er det min anbefaling at det ændres. Først tager vi en kopi af den fil vi arbejder med, så vi altid kan gå tilbage til den oprindelige tilstand.</p>

<code class="cmd">sudo cp /etc/apt/sources.list /etc/apt/sources.list.backup</code>

<p>Det som skal ændres er er adressen til opdateringerne (repositories). Da vi valgte at installere Ubuntu serveren på dansk, er adresserne sat til danske arkiver. For at ændre det skal vi fjerne referencerne til <span class="inl_cmd">dk</span> i <span class="inl_cmd">/etc/apt/sources.list</span> og til det formål anvender vi kommandoen <span class="inl_cmd">sed</span>. Kommandoen her bytter teksstrengen <span class="inl_cmd">dk.archive</span> ud med <span class="inl_cmd">archive</span>.</p>

<code class="cmd">sudo sed -i s/dk.archive/archive/ /etc/apt/sources.list</code>

<span class="afsnit">Opdater repository filerne</span>

<code class="cmd">sudo apt update</code>

<pre class="ubuntu_terminal">
thoj@mainsrv:~$ sudo apt update
Henter:1 http://security.ubuntu.com/ubuntu xenial-security InRelease [94,5 kB]
Henter:2 http://archive.ubuntu.com/ubuntu xenial InRelease [247 kB]
Henter:3 http://archive.ubuntu.com/ubuntu xenial-updates InRelease [94,5 kB]
Henter:4 http://archive.ubuntu.com/ubuntu xenial-backports InRelease [92,2 kB]
Henter:5 http://archive.ubuntu.com/ubuntu xenial/main amd64 Packages [1.201 kB]
...
</pre>

<span class="afsnit">Opgrader serveren</span>

<p>Det er min anbefaling at du vælger at lave en <span class="inl_cmd">dist-upgrade</span>, da det vilgive dig de nyeste filer.</p>

<code class="cmd">sudo apt dist-upgrade -y</code>

<p>Herunder er terminal-output for min opdatering. Som du kan se får du en beskrivelse af hvilke papper der opggraderes, hvor mange, hvor meget der skal hentes og hvor meget det kommer til at fylde når opgraderingerne er færdige </p>

<pre class="ubuntu_terminal">
thoj@mainsrv:~$ sudo apt dist-upgrade -y
Indlæser pakkelisterne... Færdig
Opbygger afhængighedstræ        
Læser tilstandsoplysninger... Færdig
Beregner opgraderingen... Færdig
Følgende NYE pakker vil blive installeret:
  libpython3.5 linux-headers-4.4.0-28 linux-headers-4.4.0-28-generic
  linux-image-4.4.0-28-generic linux-image-extra-4.4.0-28-generic
Følgende pakker vil blive opgraderet:
  accountsservice apport apt apt-transport-https apt-utils base-files
  bash-completion bind9-host bsdutils command-not-found command-not-found-data
  dh-python distro-info-data dmidecode dnsmasq-base dnsutils dosfstools dpkg
  gcc-5-base grep init init-system-helpers initramfs-tools initramfs-tools-bin
  initramfs-tools-core language-selector-common libaccountsservice0
  libapt-inst2.0 libapt-pkg5.0 libbind9-140 libblkid1 libdns-export162
  libdns162 libdrm2 libexpat1 libfdisk1 libglib2.0-0 libglib2.0-data
  libgnutls-openssl27 libgnutls30 libisc-export160 libisc160 libisccc140
  libisccfg140 libldap-2.4-2 liblwres141 liblxc1 libmount1 libpam-systemd
  libplymouth4 libsmartcols1 libssl1.0.0 libstdc++6 libsystemd0 libtasn1-6
  libudev1 libuuid1 libxml2 linux-firmware linux-generic linux-headers-generic
  linux-image-generic lsb-base lsb-release lshw lxc-common lxcfs lxd
  lxd-client mdadm mount mtr-tiny openssh-client openssh-server
  openssh-sftp-server openssl plymouth plymouth-theme-ubuntu-text
  python3-apport python3-commandnotfound python3-distupgrade
  python3-problem-report python3-software-properties python3-urllib3
  shared-mime-info snapd software-properties-common sudo systemd systemd-sysv
  ubuntu-core-launcher ubuntu-release-upgrader-core udev util-linux
  uuid-runtime vim vim-common vim-runtime vim-tiny wget
100 opgraderes, 5 nyinstalleres, 0 afinstalleres og 0 opgraderes ikke.
142 MB skal hentes fra arkiverne.
Efter denne handling, vil 304 MB yderligere diskplads være brugt.
Henter:1 http://archive.ubuntu.com/ubuntu xenial-updates/main amd64 base-files amd64 9.4ubuntu4.1 [68,4 kB]
...
</pre>

<span class="afsnit">Fjern alle overflødige pakker</span>


<code class="cmd">sudo apt autoremove -y</code>

<p>Når man arbejder med den nyeste ubuntu lige efter udgivelsen vil der sjældent være pakker der er overflødige, men der vil ske opgradering af programmer løbende som vil efterlade filer på harddisken som er overflødige.</p>

<pre class="ubuntu_terminal">
thoj@mainsrv:~$ sudo apt autoremove -y
Indlæser pakkelisterne... Færdig
Opbygger afhængighedstræ        
Læser tilstandsoplysninger... Færdig
0 opgraderes, 0 nyinstalleres, 0 afinstalleres og 0 opgraderes ikke.
</pre>

<span class="afsnit">Fjern overflødige kerner</span>

<p>Du vil komme til at opleve at kerne bliver opdateret ret ofte. Det skyldes at der konstant arbejdes på at forbedre sikkerheden, drivers og hastighed. Det betyder desværre også, at man risikerer at der ligger en masse data på ens harddisk, man aldrig bruger. Før man fjerne ældre kerner kontrollerer man at systemet virker som det skal ved at genstarte systemet og tjekke de tjenester man anvender. Da det er en ny installation er der endnu ikke nogen tjenester der skal kontrolleres.</p>

<p>Genstart serveren</p>

<code class="cmd">sudo reboot</code>

<p>Efter login kan du se at der ikke er nye opgraderinger, og at kernen i dette tilfælde er skiftet fra <span class="inl_cmd">4.4.0-21</span> til <span class="inl_cmd">4.4.0-28</span>.</p>

<pre class="ubuntu_terminal">
Welcome to Ubuntu 16.04 LTS (GNU/Linux 4.4.0-28-generic x86_64)

 * Documentation:  https://help.ubuntu.com
 * Management:     https://landscape.canonical.com
 * Support:        https://ubuntu.com/advantage

0 pakker kan opdateres.
0 opdateringer er sikkerhedsopdateringer.


Last login: Sat Jul  2 11:50:44 2016 from 192.168.0.77
</pre>

<p>Herefter køres følgende kommando (en linie)</p>

<code class="cmd">sudo apt purge $(dpkg -l linux-{image,headers}-"[0-9]*" | awk '/ii/{print $2}' | grep -ve $(uname -r | sed -r 's/-[a-z]+//') | sed ':a;N;$!ba;s/\n/ /g')
</code>

<pre class="ubuntu_terminal">
thoj@mainsrv:~$ sudo apt purge $(dpkg -l linux-{image,headers}-"[0-9]*" | awk '/ii/{print $2}' | grep -ve $(uname -r | sed -r 's/-[a-z]+//') | sed ':a;N;$!ba;s/\n/ /g')
[sudo] adgangskode for thoj: 
Indlæser pakkelisterne... Færdig
Opbygger afhængighedstræ        
Læser tilstandsoplysninger... Færdig
Følgende pakker vil blive AFINSTALLERET:
  linux-headers-4.4.0-21* linux-headers-4.4.0-21-generic*
  linux-image-4.4.0-21-generic* linux-image-extra-4.4.0-21-generic*
0 opgraderes, 0 nyinstalleres, 4 afinstalleres og 0 opgraderes ikke.
Efter denne handling, vil 295 MB diskplads blive frigjort.
Vil du fortsætte? [J/n]
</pre>

<p>Som du kan se bliver der fjernet i alt 295 MB, når du klikker <kbd>j</kbd>. Opdaterer du din server jævnlig (som du bør gøre), så vil der efterhånden kunne ligge gigabytes af forældede kerner. Så du bør rense din computer for kerner med jævne mellemrum.</p>

<h1>Administration af server</h1>

<p>Det er min anbefaling at du anvender SSH til at arbejde på serveren. På den måde kan den administreres fra en hvilken som helst PC der har en SSH klient installeret.</p>

<p>Anvender du Ubuntu/Linux eller Mac, er SSH indbygget i kommandoprompten. Anvender du Windows skal du anvende en SSH klient, men Microsoft er igang med at implementere SSH i Windows (siger rygterne). Derfor skal du indtil videre anvende <span class="inl_cmd">PuTTY</span> <a href="http://www.chiark.greenend.org.uk/~sgtatham/putty/download.html" target="_blank">http://www.chiark.greenend.org.uk/~sgtatham/putty/download.html</a>. Hemmesiden ser meget spartansk ud, men <span class="inl_cmd">PuTTY</span> er et godt værktøj.</p>

<p>Man tilgår serveren ved hjælp af kommandoen:</p>

<code class="cmd">ssh *brugernavn*@*IP-adresse*</code>

<p>Herunder har jeg logget på min server ved hjælp af SSH.</p>

<pre class="ubuntu_terminal">
<span class="green1">thoj@thoj-VirtualBox</span>:<span class="blue1">~</span>$ ssh thoj@192.168.0.10
thoj@192.168.0.10's password: 
Welcome to Ubuntu 16.04 LTS (GNU/Linux 4.4.0-28-generic x86_64)

 * Documentation:  https://help.ubuntu.com
 * Management:     https://landscape.canonical.com
 * Support:        https://ubuntu.com/advantage

0 pakker kan opdateres.
0 opdateringer er sikkerhedsopdateringer.


*** Genstart af computeren er påkrævet ***
Last login: Fri Jul  8 10:56:45 2016 from 192.168.0.77
<span class="green1">thoj@mainsrv</span>:<span class="blue1">~</span>$
</pre>

<p>Som du kan se er der behov for at genstarter serveren.</p>

<code class="cmd">sudo reboot</code>

<p></p>
<p></p>
<p></p>
<p></p>

	</body>

</html>
