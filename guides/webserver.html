<!DOCTYPE html>

<head>
	
	<meta charset="UTF-8" lang="da"/>

	<title>Webserver - Thomas Jensen</title>

	<link rel="stylesheet" href="../css/styles/docco.css" />

	<link rel="stylesheet" href="../css/style.css" />

	<link href='http://fonts.googleapis.com/css?family=Ubuntu+Mono|Ubuntu|Ubuntu+Condensed' rel='stylesheet' type='text/css'>
	
	<script src="../js/toc2.js" type="text/javascript"></script>
	<script src="https://code.jquery.com/jquery-2.2.2.js"></script>
	<script src="../js/highlight.pack.js" type="text/javascript"></script>
	<script>hljs.initHighlightingOnLoad();</script>

</head>

<!-- 

code highlighter : https://highlightjs.org/

code converter : http://www.freebits.co.uk/convert-html-code-to-text.html 

-->

<html>

<body onload="generateTOC(document.getElementById('toc'));">

<footer id="license"></footer>

	<script> $( "#license" ).load( "license.html" ); </script>

	<div id="toc">
	<p>Indholdsfortegnelse</p>
	
	</div>

<div class="title">Webserver med Linux</div>
	
<h1>Introduktion til deling af netværksdrev</h1>

<p>I denne guide vil der være en gennemgang af nogle af de fildelings muligheder Ubuntu tilbyder. Der vil blive gennemgået:</p>

<table class="">
	<thead>
		<tr>
			<th>Server</th>
			<th>Beskrivelse</th>
		</tr>
	</thead>
	<tbody>
		<tr>
			<td>www-server</td>
			<td></td>
		</tr>

		<tr>
			<td>FTP</td>
			<td></td>
		</tr>
		<tr>
			<td>Owncloud</td>
			<td></td>
		</tr>
		
	</tbody>
</table>

<h1>FTP</h1>

<p>FTP er en funktion der giver brugere adgang til filer på serveren. Herunder opsætter vi en FTP server, hvor serverens brugere får adgang til deres hjemmemapper og intet andet. På denne måde kan de hver især tilgå deres filer og hjemmeside. I denne guide anvendes <span class="inl_cmd">vsftpd</span>. Installer <span class="inl_cmd">vsftp</span> med følgende kommando:</p>

<code class="cmd">sudo apt-get install vsftpd -y</code>

<p>Når man installerer <span class="inl_cmd">vsftpd</span> kan man som udgangspunkt intet. Man skal konfigurere det som programmet skal kunne i filen <span class="inl_cmd">/etc/vsftpd.conf</span>. Vi vil konfigurere <span class="inl_cmd">vsftpd</span> sådan at:</p>

<ol class="">
	<li>brugere på computeren kan uploade og ændre i filer (write_enable), og at de bliver låst til deres home-mappe (chroot)</li>
	<li>der bliver en offentlig mappe alle kan tilgå og downloade fra (anonymous FTP)</li>
</ol>

<span class="afsnit">Sætte brugerrettigheder</span>

<p>For at aktivere brugerne på systemet skal der aktiveres to linier i <span class="inl_cmd">/etc/vsftpd.conf</span> ved at fjerne <span class="inl_cmd">#</span> og der skal tilføjes en linie:</p>

<pre class="black">
# Uncomment this to enable any form of FTP write command.
write_enable=YES <span class="red">&lt;--- hashtag (#) fjernes</span>

… 

# chroot_list_enable below.
chroot_local_user=YES <span class="red">&lt;--- hashtag (#) fjernes</span>
allow_writeable_chroot=YES <span class="red">&lt;--- Denne linie tilføjes</span>
</pre>

<p>Pga. sikkerhedsniveauet i <span class="inl_cmd">vsftpd</span> skal følgende linie tilføjes, for at brugeren kan oprette og redigere filer i sin mappe.:</p>

<span class="afsnit">Opret Anononym FTP</span>

<p>For at lave en offentlig FTP server, hvor folk kan downloade fra ændres følgende linie:</p>

<pre class="black">
anonymous_enable=No
</pre>

<p>til</p>

<pre class="black">
anonymous_enable=Yes
</pre>

<p>Herefter vil filer der lægges i <span class="inl_cmd">/srv/ftp</span> være offentligt tilgængelig.</p>


<p>Genstart vsftpd</p>

<code class="cmd">service vsftpd restart</code>

<pre class="ubuntu_terminal">
thoj@mainsrv:~$ service vsftpd restart
<span class="red">==== AUTHENTICATING FOR org.freedesktop.systemd1.manage-units ===</span>
Authentication is required to restart 'vsftpd.service'.
Authenticating as: Thomas Jensen,,, (thoj)
Password: 
<span class="red">==== AUTHENTICATION COMPLETE ===</span>
</pre>

<p>Hvis vi kigger på rettigheder til ftp mappen (<span class="inl_cmd">/srv/ftp</span>) kan vi se at den tilhører <span class="inl_cmd">root</span>, men at gruppen <span class="inl_cmd">ftp</span> har ret til læse og køre programmer derfra.</p>

<pre class="ubuntu_terminal">
thoj@mainsrv:~$ ls -al /srv
totalt 28
drwxr-xr-x  4 root root  4096 jul  2 23:48 .
drwxr-xr-x 24 root root  4096 jul  2 12:11 ..
drwxr-xr-x  2 root ftp   4096 jul  2 23:48 ftp
drwx------  2 root root 16384 jul  2 11:30 lost+found
</pre>

<h2>Test FTP med Filezilla</h2>

<p>Installer Filezilla på klienten.</p>

<code class="cmd">sudo apt-get install filezilla -y</code>

<p>For at teste det virker opretter vi to testfiler. En i vores hjemmemappe og en i <span class="inl_cmd">/srv/ftp</span>.</p>

<pre class="ubuntu_terminal">
thoj@mainsrv:~$ touch ~/testfile
thoj@mainsrv:~$ sudo touch /srv/ftp/testfile_ftp
</pre>

<p>Vi behøver ikke bekymre os om filrettigheder, da de filer root opretter som standard har læseadgang for både gruppe og alle. Lad os kigge på filerne og deres rettigheder:</p>

<pre class="ubuntu_terminal">
thoj@mainsrv:~$ ls ~ -al | grep testfile 
-rw-rw-r-- 1 thoj thoj    0 jul  3 00:31 <span class="red">testfile</span>
thoj@mainsrv:~$ ls /srv/ftp/ -al | grep testfile 
-rw-r--r-- 1 root root    0 jul  3 00:38 <span class="red">testfile</span>_ftp
</pre>

<p>Når man starter filezilla har man mulighed for at indtaste ens bruger oplysninger. Først med anonym bruger:</p>

<figure id="">

	<img class="p90" src="images/ftp_filezilla_anonymous.png" alt="" title="" />

	<figcaption></figcaption>

</figure>

<p>På venstre side har man sin egen computer og på højre side er FTP-serveren. Som du kan se ligger filen <span class="inl_cmd">testfile_ftp</span> i mappen. Man overfører filen ved at trække den over eller dobbeltklikke på den.</p>

<p>Herunder er der valgt en der har en bruger på FTP-serveren:</p>

<figure id="">

	<img class="p90" src="images/ftp_filezilla_user.png" alt="" title="" />

	<figcaption></figcaption>

</figure>

<p>Læg mærke til at FTP-brugeren er låst til sin hjemmemappe. Havde vi ikke chrooted brugeren, ville brugeren have haft adgang til hele filstrukturen.</p>

<h2>Test FTP med kommandolinien</h2>

<p>Man kan også logge på ftp serveren ved hjælp af kommandolinien. Her kører man blot kommandoen:</p>

<code class="cmd">ftp 10.0.2.10</code>

<p>Efter kommandoen er kørt beder FTP-serveren om brugernavn og password. Herunder logger jeg på FTP-serveren fra en Ubuntu klient:</p>

<pre class="ubuntu_terminal">
<span class="green1">thoj@thoj-VirtualBox</span>:<span class="blue1">~</span>$ ftp 10.0.2.10
Connected to 10.0.2.10.
220 (vsFTPd 3.0.3)
Name (10.0.2.10:thoj): thoj
331 Please specify the password.
Password:
230 Login successful.
Remote system type is UNIX.
Using binary mode to transfer files.
ftp> 
</pre>

<p>læg mærke til at kommandoprompten bliver afløst af: <span class="inl_cmd">ftp&gt;</span>. Her kan man køre forskellige kommandoer:</p>

<table class="">
	<thead>
		<tr>
			<th>Kommando</th>
			<th>Beskrivelse</th>
		</tr>
	</thead>
	<tbody>
		<tr>
			<td>ls</td>
			<td>Viser indholdet af mappen</td>
		</tr>
		<tr>
			<td>cd</td>
			<td>Skift mappe</td>
		</tr>
		<tr>
			<td>mkdir / rmdir</td>
			<td>Opret en mappe - slet en mappe</td>
		</tr>
		<tr>
			<td></td>
			<td></td>
		</tr>
	</tbody>
</table>

<h2>Test FTP med browseren</h2>

<p></p>

<figure id="">

	<img class="p90" src="images/ftp_browser.png" alt="" title="" />

	<figcaption></figcaption>

</figure>

<h1>Fildeling over web</h1>

<p>For at kunne dele filer over web, skal vi anvende en webserver - i Linux sammenhæng kaldet en LAMP server, da den består af: <span class="bold">L</span>inux, <span class="bold">A</span>pache, <span class="bold">M</span>ySQL og <span class="bold">P</span>hp.

<p>Vi anvender programmet <span class="inl_cmd">tasksel</span> til at installere LAMP serveren med, da det automatiserer processen for os. Installerer du LAMP på en server er det allerede installeret, og du anvendte det til at installere OpenSSH serveren under installationen.</p>

<h2>Installer <span class="inl_cmd">tasksel</span> (Klient)</h2>

<p>Det er kun nødvendigt at installere <span class="inl_cmd">tasksel</span> hvis du anvender en klient.</p>

<p><span class="inl_cmd">tasksel</span> installeres på følgende på. Husk at opdatere repositories både før og efter installationen.</p>

<code class="cmd">apt-get update</code>

<code class="more_cmd">apt-get install tasksel -y</code>

<code class="more_cmd">apt-get update</code>

<h2>Installer LAMP</h2>

<p>LAMP-serveren kan installeres på to måder med tasksel: Ved hjælp af kommandolinien eller ved hjælp af en GUI. For at køre installationen direkte fra kommandolinien skal du køre nedestående kommandolinie. Vær opmærksom på, at du under installationen bliver bedt om at angive en adgangskode (anvend: 123qwe) til MySQL' rootbruger.</p>

<code class="cmd">tasksel install lamp-server</code>

<p>For at installere ved hjælp af den GUI der følger med <span class="inl_cmd">tasksel</span> kører du blot kommandoen:</p>

<code class="cmd">tasksel</code>

<p>Herefter kommer følgende skærmbillede frem, hvor du med piletasterne vælger "LAMP server", markerer med [Mellemrum], flytter markeringen ned til "OK" med [Tab] og trykker [Enter]</p>

<figure id="">

	<img class="" src="images/fildeling_tasksel_LAMP.png" alt="" title="" />

	<figcaption></figcaption>

</figure>

<h2>Adgang til webserverens html mappe</h2>

<p><span class="inl_cmd">root</span> er normalt ejeren af webserverens html mappe (<span class="inl_cmd">/var/www/html</span>), men hvis det er en lille privat server kan det være en fordel at ændre rettighederne sådan at det bliver din brugers mappe og give direkte adgang til mappen ved hjælp af et "soft-link".</p>

<p>Ændr bruger og skriverettighederne i <span class="inl_cmd">/var/www/html</span></p>

<code class="cmd">chown -R *brugernavn*:*brugernavn* /var/www/html</code>

<code class="cmd">chmod -R 705 /var/www.html</code>

<p>Gå tilbage til din egen bruger og opret en <span class="inl_cmd">html</span> mappe i din hjemmemappe</p>

<code class="cmd">su *brugernavn*</code>

<code class="more_cmd">mkdir ~/html</code>

<p>Lav vi et "soft"-link, sådan at du får adgang til /var/www/html fra din egen mappe:</p>

<code class="cmd">ln -s /var/www/html/ ~/html</code>

<p>Herefter er mappen <span class="inl_cmd">~/html</span> linket til <span class="inl_cmd">/var/www/html</span> og du kan navigere direkte til <span class="inl_cmd">html</span> mappen fra din hjemmemappe.</p>

<pre class="ubuntu_terminal">
thoj@testweb:~$ ln -s /var/www/html/ ~/html
thoj@testweb:~$ ls -al
totalt 28
drwxr-xr-x 3 thoj thoj 4096 aug 28 13:39 .
drwxr-xr-x 3 root root 4096 aug 24 13:45 ..
-rw------- 1 thoj thoj  141 aug 26 13:30 .bash_history
-rw-r--r-- 1 thoj thoj  220 aug 24 13:45 .bash_logout
-rw-r--r-- 1 thoj thoj 3637 aug 24 13:45 .bashrc
drwx------ 2 thoj thoj 4096 aug 24 13:47 <span class="blue1">.cache</span>
lrwxrwxrwx 1 thoj thoj   14 aug 28 13:39 <span class="turk">html</span> -> <span class="blue1">/var/www/html/</span>
-rw-r--r-- 1 thoj thoj  675 aug 24 13:45 .profile
</pre>

<h2>Personlige hjemmesider</h2>

<p>Hvis man har flere brugere på webserveren kan man give hver af dem deres egen hjemmeside på webserveren. Den kan så tilgås fra adressen: <span class="inl_cmd">*serveradresse*/~*brugernavn*</span></p>

<p>Alle brugere bliver oprettet ud fra en skabelon som ligger i <span class="inl_cmd">/etc/skel</span>.</p>

<pre class="ubuntu_terminal">
thoj@tjmainsrv:/etc/skel$ ls -al
total 20
drwxr-xr-x  2 root root 4096 dec  4 08:08 .
drwxr-xr-x 98 root root 4096 dec 16 11:30 ..
-rw-r--r--  1 root root  220 apr  9  2014 .bash_logout
-rw-r--r--  1 root root 3637 apr  9  2014 .bashrc
-rw-r--r--  1 root root  675 apr  9  2014 .profile
</pre>

<p>I denne mappe skal vi have oprettet en privat www-mappe</p>

<code class="cmd">mkdir -p /etc/skel/public_html/images /etc/skel/public_html/css /etc/skel/public_html/js</code>

<p>Herefter opretter vi filerne <span class="inl_cmd">index.html</span> og <span class="inl_cmd">phptest.html</span> og indsætter lidt indhold.</p>

<code class="cmd">echo "&lt;h1&gt;Din hjemmeside&lt;/h1&gt;" &gt; /etc/skel/public_html/index.html </code>

<code class="more_cmd">echo "&lt;?php phpinfo(); ?&gt;" &gt;&gt; /etc/skel/public_html/testphp.php</code>

<p>Vi kan tjekke filstrukturen med kommandoen:</p>

<code class="cmd">tree /etc/skel -a --dirsfirst</code>

<pre class="ubuntu_terminal">
root@tjmainsrv:/etc/skel/public_html# tree /etc/skel -a --dirsfirst
<span class="blue1">/etc/skel</span>
├── <span class="blue1">public_html</span>
│   ├── <span class="blue1">css</span>
│   ├── <span class="blue1">images</span>
│   ├── <span class="blue1">js</span>
│   ├── index.html
│   └── testphp.php
├── .bash_logout
├── .bashrc
└── .profile

4 directories, 5 files
</pre>

<p>På webservere er det normen at man giver filerne 705 rettigheder. På den måde har ejeren af mappen læse, skrive og execute på alle filer, men alle andre kan læse og execute.</p>

<code class="cmd">chmod -R 705 /etc/skel/public_html</code>

<p>Apache2 har slået PHP fra i brugerens directories. For at slå det til skal vi udkommentere følgende i <span class="inl_cmd">/etc/apache2/mods-enabled/php5.conf</span> (markeret med rød):</p>

<pre class="black">
# Running PHP scripts in user directories is disabled by default
#
# To re-enable PHP in user directories comment the following lines
# (from &lt;IfModule ...&gt; to &lt;/IfModule&gt;.) Do NOT set it to On as it
# prevents .htaccess files from disabling it.
<span class="red">#&lt;IfModule mod_userdir.c&gt;
#    &lt;Directory /home/*/public_html&gt;
#        php_admin_flag engine Off
#    &lt;/Directory&gt;
#&lt;/IfModule&gt;</span>
</pre>


<p>Som det sidste skal vi have aktiveret brugernes webfolders i apache2 og genstartet tjenesten</p>

<code class="cmd">a2enmod userdir && service apache2 restart</code>

<p>Vær opmærksom på, at du får en fejlmeddelelse hvis du genstarter Apache på en klient:</p>

<pre class="ubuntu_terminal">
root@thoj-VirtualBox:/home/thoj# service apache2 restart
 * Restarting web server apache2                                                
 AH00558: apache2: Could not reliably determine the server's fully qualified domain name, using 127.0.1.1. Set the 'ServerName' directive globally to suppress this message
                                                                                            [ OK ]
root@mainsrv:/home/thoj# 
</pre>

<p>Det skyldes at klienter ikke er konfigureret med et FQDN.</p>

<p>Test ved at oprette brugeren <span class="inl_cmd">testweb</span> og naviger til <span class="inl_cmd">10.0.2.10/~testweb</span> i en browser og tilgå brugerens mappe over FTP. Vær opmærksom på at det kun er brugere, der er oprettet efter ændringen der får oprettet disse mapper.</p>

<figure id="">

	<img class="p90" src="images/fildeling_privat_web.png" alt="" title="" />

	<figcaption></figcaption>

</figure>

<p>Vær opmærksom på at det kun er brugere, der er oprettet efter ændringen der får oprettet disse mapper. Ønsker du at give de oprindelige brugere deres egen web-mappe skal de kopieres ind og der skal ændres ejerskab. Erstat <span class="red">*brugernavn*</span> med brugeren der skal have adgang til web-mappen.</p>

<code class="cmd">cp -R /etc/skel/public_html /home/<span class="red">*brugernavn*</span></code>

<code class="more_cmd">chown -R <span class="red">*brugenavn*</span>:<span class="red">*brugenavn*</span> /home/<span class="red">*brugenavn*</span></code>

<h2>Optimer PHP</h2>

<p>PHP er installeret i en  "standard" version, og derfor kan de optimeres. Vi skal have konfigureret følgende. PHP konfigureres igennem filen <span class="inl_cmd">/etc/php5/apache2/php.ini</span>. Læg mærke til at tegnet <span class="inl_cmd">;</span> udkommenterer linier og skal fjernes før linien bliver aktiv.</p>

<h3>OPcache</h3>

<p>OPcache er en indbygget funktion i PHP, der laver en cache for kørte PHP-programmer. På den måde minimerer man belastningen af CPU og harddisk. Her laver vi et simpelt setup, hvor fire parametre skal ændres:</p>

<ol class="">
	<li>OPcache skal aktiveres</li>
	<li>Mængden af RAM der afsættes til Cache skal sættes</li>
	<li>Antallet af scripts der kan </li>
	<li>Hvor ofte det enkelte script skal kontrolleres for at være aktivt</li>
</ol>

<p>Fremgangsmåden er taget fra: <a href="http://www.hostingadvice.com/how-to/enable-php-5-5-opcache-ubuntu-14-04/" target="_blank">http://www.hostingadvice.com/how-to/enable-php-5-5-opcache-ubuntu-14-04/</a></p>

<p>I linien <span class="inl_cmd">;opcache.enable=0</span> fjernes <span class="inl_cmd">;</span> og værdien sættes til <span class="inl_cmd">1</span></p>

<pre class="black">
; Determines if Zend OPCache is enabled
opcache.enable=1
</pre>

<p>I linien <span class="inl_cmd">;opcache.memory_consumption=64</span> fjernes <span class="inl_cmd">;</span> og værdien beholdes (Antal Mb).</p>

<pre class="black">
; Determines if Zend OPCache is enabled
opcache.memory_consumption=64
</pre>

<p>I linien <span class="inl_cmd">;opcache.max_accelerated_files=2000</span> fjernes <span class="inl_cmd">;</span> og værdien beholdes</p>

<pre class="black">
; Determines if Zend OPCache is enabled
opcache.max_accelerated_files=2000
</pre>

<p>I linien <span class="inl_cmd">;opcache_revalidate_freq = 2</span> fjernes <span class="inl_cmd">;</span> og værdien sættes til <span class="inl_cmd">240</span> (sekunder = 4 minutter)</p>

<pre class="black">
; Determines if Zend OPCache is enabled
;opcache_revalidate_freq = 240
</pre>

<p>Afslut <span class="inl_cmd">nano</span> og start OPcache modulet</p>

<code class="cmd">php5enmod opcache</code>

<p>Genstart Apache</p>

<code class="cmd">service apache2 restart</code>


<h3>xsendfile</h3>

<p>Et smart program at have installeret</p>

<code class="cmd">apt-get install libapache2-mod-xsendfile -y</code>

<p>Installationsprocessen genstarter selv Apache serveren.</p>

<h1>Webinterfaces</h1>

<h2>PHPMyAdmin</h2>

<p>For at administrere MySQL databaser anvender man ofte PHPMyAdmin</p>

<code class="cmd">apt-get install phpmyadmin -y</code>

<figure id="">

	<img class="p90" src="images/fildeling_phpmyadmin.png" alt="" title="" />

	<figcaption></figcaption>

</figure>

<h2>Webmin</h2>

<p>Webmin er et webinterface til at tilgå serveren med. Den indeholder mange konfigurationsmuligheder. Tilføj 2 repositories til <span class="inl_cmd">/etc/apt/sources.list</span></p>

<pre class="black">
deb http://download.webmin.com/download/repository sarge contrib
deb http://webmin.mirror.somersettechsolutions.co.uk/repository sarge contrib
</pre>

<p>Hent og installer webmins GPG nøgle</p>

<code class="cmd">cd /root</code>

<code class="more_cmd">wget http://www.webmin.com/jcameron-key.asc -O- | apt-key add -</code>

<p>Opdater apt og installer webmin</p>

<code class="cmd">apt-get update && apt-get install webmin -y</code>

<p>Efter installationen er færdig kan du tilgå webmin ved at anvende adressen <a href="https://10.0.2.10:10000" target="_blank">https://10.0.2.10:10000</a>. Logger du ind med en bruger fra sudo gruppen har du administratorrettigheder når webmin kører.</p>

<figure id="">

	<img class="p90" src="images/fildeling_webmin.png" alt="" title="" />

	<figcaption></figcaption>

</figure>

<p>Som du kan se giver webmin et overblik over serverens status, og giver adgang til de tjenester du har installeret. Webmin er et meget kraftfuldt værktøj og har automatiseret mange af de opgaver man skal udføre som administrator. Som alle andre værktøjer på en server skal man tænke sig om når man anvender det.</p>


<h1>OwnCloud</h1>

<p>Indtil videre har vi beskæftiget os med ”gamle” tjenester. I de sidste par år er skyen og onlinetjenester kommet i fokus. Google, Dropbox, iCloud og lignendeer tjenester som rigtig mange af os anvender til mail, kalender, kontaker,dokumenter, billeder, filer, backup osv.</p>

<p>Owncloud er en opensource løsning for privatpersoner og firmaer, som er under konstant udvikling og med version 7 indeholder den både mulighed for at tage backup af dokumenter, skrive dokumenter osv. Med owncloud kan du køre din helt egen private løsning og få al den lagerplads du vil investere i.</p>

<p>Da det er et projekt i rivende udvikling er det også mere omstændigt at installere. Du kan installere owncloud i ældre versioner med apt-get, men vi ønsker at bruge den nyeste version.</p>

<h2>Installer owncloud</h2>

<p>Tilføj ownclouds repositorie (skal køres som en linie)</p>

<code class="cmd">sudo sh -c "echo 'deb http://download.opensuse.org/repositories/isv:/ownCloud:/community/xUbuntu_14.04/ /' >> /etc/apt/sources.list.d/owncloud.list"</code>

<p>Tilføj sikkerhedsnøglen</p>

<code class="cmd">cd /root</code>

<code class="more_cmd">wget http://download.opensuse.org/repositories/isv:ownCloud:community/xUbuntu_14.04/Release.key -O- | apt-key add -</code>

<p>Opdater og installere</p>

<code class="cmd">apt-get update && apt-get install owncloud -y</code>

<p>Opret mappen OwnCloud filerne skal ligge i:</p>

<code class="cmd">mkdir -p /srv/owncloud</code>

<p>Vi skal nu have sat rettighederne for mappen. I Ubuntu findes der en ”www-data” bruger som man anvender til at give de rigtige rettigheder til webmapper der skal være generelt tilgængelige.</p>

<code class="cmd">sudo chown -R www-data:www-data /srv/owncloud</code>

<p>Owncloud kan konfigureres enten ved at anvende en minimal database (SQLite) eller ved at anvende en Ordinær database. Hvis man har mange brugere og har behov for at kunne konfigurere databasen bør man vælge enten MySQL/MariaDB eller PostgreSQL - ønsker man blot at anvende det til mindre end 20-30 personer er SQLite mere end rigeligt.</p>

<h2>Opret database</h2>

<p>Før vi går i gang med at konfigurere owncloud skal vi have oprettet en en owncloud administrator, en database og en tabel. Det første vi skal have gjort er at oprette en forbindelse til mysql-serveren. Det gøres med kommandoen:</p>

<code class="cmd">mysql -u root -p</code>

<p>Kommandoen overfor logger dig på som phpmyadmins root, og beder dig om root brugerens password</p>

<pre class="ubuntu_terminal">
root@mainsrv:/home/thoj# mysql -u root -p
Enter password: 
Welcome to the MySQL monitor.  Commands end with ; or \g.
Your MySQL connection id is 53
Server version: 5.5.37-0ubuntu0.14.04.1 (Ubuntu)

Copyright (c) 2000, 2014, Oracle and/or its affiliates. All rights reserved.

Oracle is a registered trademark of Oracle Corporation and/or its
affiliates. Other names may be trademarks of their respective
owners.

Type 'help;' or '\h' for help. Type '\c' to clear the current input statement.

mysql>
</pre>

<p>Vi skal gøre følgende:</p>

<ol class="">
	<li>Oprette en ny database ”owncloud”</li>
	<li>Oprette en bruger (owncloudadmin) og hans password (1234)</li>
	<li>Give brugeren rettigheder til databasen vi har lavet</li>
	<li>Lukke forbindelsen til MySQLserveren</li>
</ol>

<p>1. opret databasen ”owncloud”</p>

<code class="cmd">CREATE DATABASE owncloud;</code>

<p>2. Oprette en bruger - ”owncloudadmin” og giv ham adgangskoden "123qwe"</p>

<code class="cmd">CREATE USER owncloudadmin@localhost IDENTIFIED BY '123qwe';</code>

<p>Giv brugeren adgang fuld adgang til databasen vi har oprettet</p>

<code class="cmd">GRANT ALL PRIVILEGES ON owncloud.* TO owncloudadmin@localhost;</code>

<p>Luk forbindelsen til MySQL serveren ned</p>

<code class="cmd">exit</code>

<h2>Konfigurer Owncloud</h2>

<p>Åbn adressen <a href="http://mainsrv.network.local/owncloud/" target="_blank">http://10.0.2.10/owncloud/</a> og konfigurer serveren færdig. (Se screenshot herunder)</p>

<table class="">
	<tbody>
		<tr>
			<td>Owncloud administrator</td>
			<td>Brugernavn</td>
		</tr>
		<tr>
			<td>Owncloud administrator kodeord</td>
			<td>*****</td>
		</tr>
		<tr>
			<td>Datamappe</td>
			<td><span class="inl_cmd">/srv/owncloud</span></td>
		</tr>
		<tr>
			<td>Database</td>
			<td>MySQL / MariaDB</td>
		</tr>
		<tr>
			<td>DB bruger</td>
			<td>owncloudadmin</td>
		</tr>
		<tr>
			<td>DB bruger password</td>
			<td>123qwe</td>
		</tr>
		<tr>
			<td>DB navn</td>
			<td>owncloud</td>
		</tr>
		<tr>
			<td>DB adresse</td>
			<td>localhost</td>
		</tr>
	</tbody>
</table>
	
	<figure id="">
				
		<img class="p40" src="images/fildeling_owncloud.png" alt="" title="" />
				
		<figcaption></figcaption>
				
	</figure>
			
<p>Når du er logget ind kan du konfigurere ownCloud færdig ved at klikke på dit brugernavn i øverste højre hjørne</p>

<figure id="">

	<img class="p25" src="images/owncloud_setup_02.png" alt="" title="" />

	<figcaption></figcaption>

</figure>

<h2>Konfigurering af filstørrelse</h2>

<p>Som standard er owncloud sat til at filer ikke må være større end 513 MB. For at ændre dette skal vi have ændret i den skjulte fil <span class="inl_cmd">.htacces</span>, der ligger i ownclouds webmappe /var/www/owncloud.</p>

<code class="cmd">nano /var/www/owncloud/.htaccess</code>

<pre class="black">
&lt;IfModule mod_php5.c&gt;
<span class="red">php_value upload_max_filesize 513M
php_value post_max_size 513M</span>
php_value memory_limit 512M
php_value mbstring.func_overload 0
&lt;IfModule env_module&gt;
</pre>

<p>Ændr <span class="inl_cmd">php_value upload_max_filesize</span> og <span class="inl_cmd">php_value post_max_size</span> fra <span class="inl_cmd">513M</span> til <span class="inl_cmd">4G</span> (513 Mb til 4Gb), sådan at der står:</p>

<pre class="black">
&lt;IfModule mod_php5.c&gt;
<span class="red">php_value upload_max_filesize 4G
php_value post_max_size 4G</span>
php_value memory_limit 512M
php_value mbstring.func_overload 0
&lt;IfModule env_module&gt;
</pre>

<p>Da <span class="inl_cmd">.htaccess</span> bliver læst før hver request af Apache2, skal den ikke genindlæses. Efter ændringen vil brugerne kunne uploade filer på op til 4Gb.</p>

<p></p>
<p></p>
<p></p>
<p></p>





	</body>

</html>





