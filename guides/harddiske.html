<!DOCTYPE html>
<html lang="en">
<head>
  <title>Vidas.dk</title>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  
  <link href='http://fonts.googleapis.com/css?family=Ubuntu+Mono|Ubuntu|Ubuntu+Condensed' rel='stylesheet' type='text/css'>

  <link rel="stylesheet" href="../css/bootstrap.min.css">
  <link rel="stylesheet" href="../css/jquery-ui.min.css">
  <link rel="stylesheet" href="../css/jquery.tocify.css">
  <link rel="stylesheet" href="../css/style_new.css" />
<!-- Scripts in bottom to speed up pageload-->
 

</head>
<body>
	
	
<div class="container-fluid">

<div class="row-fluid">
	
<div class="col-sm-3">
	
	<div id="toc">
	
		<div id="toc_headline"></div>
	
	</div>

</div><!-- Start slut 1. kolonne - TOC -->
	
<div class="col-sm-9">
	

<div class="title">Harddiske på Linux</div>



<h1>Lagerenheder på Linux systemer</h1>

<p>I Linux er lagerenheder integreret i filsystemet på to forskellige niveauer: den fysiske disk/partition og monteringspunktet. Skemaet herunder beskriver hvordan de fysiske enheder er præsenteret i filsystemet.</p>

<table class="">
	<thead>
		<tr>
			<th></th>
			<th></th>
		</tr>
	</thead>
	<tbody>
		<tr>
			<td colspan="2">Harddiske og USB-diske</td>
		</tr>
		<tr>
			<td>1. harddisk</td>
			<td><span class="inl_cmd">/dev/sda</span></td>
		</tr>
		<tr>
			<td>2. harddisk</td>
			<td><span class="inl_cmd">/dev/sdb</span></td>
		</tr>		
		<tr>
			<td>3. harddisk</td>
			<td><span class="inl_cmd">/dev/sdc</span></td>
		</tr>
		<tr>
			<td colspan="2">CD/DVD</td>
		</tr>
		<tr>
			<td>1. CD/DVD</td>
			<td><span class="inl_cmd">/dev/sr0</span></td>
		</tr>			
		<tr>
			<td>2. CD/DVD</td>
			<td><span class="inl_cmd">/dev/sr1</span></td>
		</tr>
	</tbody>
</table>

<p>Læg mærke til at SATA og USB diske har samme betegnelse. Det skyldes at begge er indeholder partitionstabeller og dermed kan indeholde en eller flere partitioner. Modsat har CD/DVD'er ikke partitionstabeller og derved bliver monteret per enhed.</p>

<p>Hvis en enhed indeholder flere partitioner angives den enkelte partition ud fra dets oprettelse. De primære med tallene 1-4 og de logiske med 5 og frem. Herunder er angivet et eksempel hvor der er installeret en harddisk og isat en USB disk:</p>

<table class="">
	<thead>
		<tr>
			<th>Fysiske disk - partition</th>
			<th>Diskens placering i filsystemet</th>
			<th>Navngivning i Windows 7 &#8594; </th>
		</tr>
	</thead>
	<tbody>
		<tr>
			<td>1. disk - 1. partition (primær)</td>
			<td><span class="inl_cmd">/dev/sda1</span></td>
			<td>Ikke synlig - boot partition</td>
		</tr>
		<tr>
			<td>1. disk - 2. partition (primær)</td>
			<td><span class="inl_cmd">/dev/sda2</span></td>
			<td>C:</td>
		</tr>
		<tr>
			<td>1. disk - 3. partition (logisk)</td>
			<td><span class="inl_cmd">/dev/sda5</span></td>
			<td>D:</td>
		</tr>
		<tr>
			<td>1. disk - 4. partition (logisk)</td>
			<td><span class="inl_cmd">/dev/sda6</span></td>
			<td>E:</td>
		</tr>
		<tr>
			<td>2. disk - 1. partition (primær)</td>
			<td><span class="inl_cmd">/dev/sdb1</span></td>
			<td>F:</td>
		</tr>
	</tbody>
</table>

<p>Navngivningen af drevene på et Windows7+ system kan være anderledes end det er angivet ovenfor. Navngivningen af C drevet vil altid være systempartitionen, men denne kan f.eks. være den 3. partition på 1. disk. Derfor bør man altid tjekke harddiskkonfigurationen med <span class="inl_cmd">lsblk</span> eller <span class="inl_cmd">fdisk -l</span>. Se eksemplet herunder:</p>

<pre class="ubuntu_terminal">
<span class="green1">thoj@thoj-VirtualBox</span>:<span class="blue1">~</span>$ lsblk
NAME   MAJ:MIN RM  SIZE RO TYPE MOUNTPOINT
sda      8:0    0  100G  0 disk 
├─sda1   8:1    0 46,6G  0 part /
├─sda2   8:2    0  3,8G  0 part [SWAP]
└─sda3   8:3    0 28,9G  0 part /data
sr0     11:0    1 1024M  0 rom 
</pre>

<p>Det er disse enheder der "monteres" i filsystemet. Der skal være en <span class="inl_cmd">/</span>, men ellers kan man navngive ens monteringspunkter som man vil, f.eks: <span class="inl_cmd">/minedata</span>, <span class="inl_cmd">Backup</span>. Man kan med fordel montere en fysisk partition som f.eks. <span class="inl_cmd">/home</span>. På den måde kan man installere et nyt styresystem, og montere brugerens data og indstillinger direkte på det nye system. I ovenstående tilfælde kunne man f.eks. have <span class="inl_cmd">/dev/sda1</span> monteret som <span class="inl_cmd">/</span>.</p>

<h1>Montering af filsystemer</h1>

<p>Linux er et netværksoperativsystem og derfor er Linux ligeglad med om det er et fysisk drev eller et netværksressource der skal monteres. Drev kan monteres ved opstart gennem filen <span class="inl_cmd">/etc/fstab</span>, men kan også anvendes til løbende montere drev efter efter behov og afmontere dem med <span class="inl_cmd">umount</span>.</p>

<code class="cmd">mount -t *filsystem* *enhed* *mappe* -o *optioner*</code>

<table class="cmd_table">
	<thead>
		<tr>
			<th></th>
			<th></th>
		</tr>
	</thead>
	<tbody>
		<tr>
			<td>mount</td>
			<td>Kommandoen der monterer enhederne</td>
		</tr>
		<tr>
			<td>-t [Filsystem]</td>
			<td>Angiver hvilket filsystem der anvendes på enheden</td>
		</tr>
		<tr>
			<td>enhed</td>
			<td>Enhedens placering i <span class="inl_cmd">/dev</span></td>
		</tr>
		<tr>
			<td>mappe</td>
			<td>Der hvor drevet skal monteres i filstrukturen</td>
		</tr>
		<tr>
			<td>optioner</td>
			<td>Videre konfiguration af monteringen.</td>
		</tr>
	</tbody>
</table>


<h2>Optioner</h2>

<p>Optionerne er dem som sætter egenskaberne for delingen. De startes med et <span class="inl_cmd">-o</span> fulgt af optionerne adskilt af kommaer (,). Herunder er et eksempel på et netværks drev der bliver monteret, hvor <span class="inl_cmd">/mnt/backup</span> bliver monteret som "read-only" og brugeren <span class="inl_cmd">thoj</span> til at verificere. Som det ses herunder kræver Ubuntu at få brugerens password.</p>

<pre class="ubuntu_terminal">
<span class="green1">thoj@thoj-VirtualBox</span>:<span class="blue1">~</span>$ sudo mount //10.0.2.10/alle /mnt/backup -o ro, user=thoj, uid=1003
Password for thoj@//10.0.2.10/alle:
</pre>

<span class="afsnit"><span class="inl_cmd">ro</span> og <span class="inl_cmd">rw</span></span>

<p>Sætter skriverettighederne i drevet. Det kan være en fordel at anvende <span class="inl_cmd">ro</span> i tilfælde hvor man det er unødvendigt at skrive til et drev, f.eks. hvis NTFS filsystemer er "brudt sammen" og man har brug for at hente data ud derfra. Ofte vil man kunne hente data ud fra en NTFS partioneret harddisk ved hjælp af <span class="inl_cmd">ro</span> også i situationer hvor windows nægter at starte op.</p>

<table class="cmd_table">
	<thead>
		<tr>
			<th></th>
			<th></th>
		</tr>
	</thead>
	<tbody>
		<tr>
			<td>user=*user*</td>
			<td>Sætter brugernavnet</td>
		</tr>
		<tr>
			<td>pass=*passwd*</td>
			<td>Sætter password. Kan ikke anbefales da det gør man skriver sin kode direkte i kommandolinien og gemmes i bash-historikken.</td>
		</tr>
		<tr>
			<td>uid=*user*</td>
			<td>Sætter brugerens id. NFS verificerer brugere ved dette ID og giver brugeren adgang til denne brugeres ressourcer på serveren</td>
		</tr>
		<tr>
			<td>gid=*group*</td>
			<td>Tilføjer brugeren til den konkrete gruppe på serveren.</td>
		</tr>
		<tr>
			<td>cred=*file*</td>
			<td>Giver adressen til en fil, hvori ens brugeroplysninger ligger</td>
		</tr>
	</tbody>
</table>

<h2><span class="inl_cmd">umask</span></h2>

<p>Som standard bliver filer oprettet med læse/skrive rettigheder til alle (<span class="inl_cmd">666</span>) og mappper med læse/skrive/udføre rettigheder (<span class="inl_cmd">777</span>). Hvis man vil ændre det gøres det med <span class="inl_cmd">umask</span>.</p>

<p><span class="inl_cmd">umask</span> fungerer ved at den trækker fra i forhold til systemets standardopsætning (<span class="inl_cmd">666</span> for filer og <span class="inl_cmd">777</span> for mapper), hvor værdierne angiver henholdsvis brugerens, gruppens og alles rettigheder.</p>

<table class="centreret">
	<thead>
		<tr>
			<th>Talværdi</th>
			<th>r <br/> 2² = 4</th>
			<th>w <br/> 2¹ = 2</th>
			<th>x <br/> 2⁰ = 1</th>
			<th>Samlet</th>
			<th>Rettigheder</th>
		</tr>
	</thead>
	<tbody>
		<tr>
			<td>7</td>
			<td>1</td>
			<td>1</td>
			<td>1</td>
			<td>rwx</td>
			<td>Alle (læse, skrive og udføre)</td>
		</tr>
		<tr>
			<td>6</td>
			<td>1</td>
			<td>1</td>
			<td>0</td>
			<td>-wx</td>
			<td>Læse og skrive</td>
		</tr>
		<tr>
			<td>5</td>
			<td>1</td>
			<td>0</td>
			<td>1</td>
			<td>r-x</td>
			<td>Læse og udføre</td>
		</tr>
		<tr>
			<td>4</td>
			<td>1</td>
			<td>0</td>
			<td>0</td>
			<td>r--</td>
			<td>Læse</td>
		</tr>
		<tr>
			<td>3</td>
			<td>0</td>
			<td>1</td>
			<td>1</td>
			<td>-wx</td>
			<td>Skrive og udføre</td>
		</tr>
		<tr>
			<td>2</td>
			<td>0</td>
			<td>1</td>
			<td>0</td>
			<td>-w-</td>
			<td>Skrive</td>
		</tr>
		<tr>
			<td>1</td>
			<td>0</td>
			<td>0</td>
			<td>1</td>
			<td>--x</td>
			<td>udføre</td>
		</tr>
		<tr>
			<td>0</td>
			<td>0</td>
			<td>0</td>
			<td>0</td>
			<td>---</td>
			<td>Ingen</td>
		</tr>		
	</tbody>
</table>

<p><span class="inl_cmd">umask</span> fungerer som sagt ved at "trække fra". Den <span class="inl_cmd">umask</span>-værdi man ofte anvender er <span class="inl_cmd">022</span>.</p>

<span class="afsnit"><span class="inl_cmd">umask</span> værdi <span class="inl_cmd">022</span> for filer:</span>

<ul class="disc">
	<li>Standard filrettighed: 666</li>
	<li><span class="inl_cmd">umask</span>: 022</li>
	<li>Filer oprettes med: 666 - 022 = 644 (rw-r--r--)</li>
</ul>

<span class="afsnit"><span class="inl_cmd">umask</span> værdi <span class="inl_cmd">022</span> for mapper:</span>

<ul class="disc">
	<li>Standard mapperettighed: 777</li>
	<li><span class="inl_cmd">umask</span>: 022</li>
	<li>Filer oprettes med: 777 - 022 = 755 (rwxr-xr-x)</li>
</ul>

<p>Hvis du ønsker at sætte sikkerhedsniveauet helt op anvendes en <span class="inl_cmd">umask</span> værdi på 077. Det vil medføre at alle rettigheder trækkes fra gruppen og alle</p>

<ul class="disc">
	<li>Filer: 666 - 077 = 600 (rw-------)</li>
	<li>Mapper: 777 - 077 = 700 (rwx------)</li>
</ul>

<p>Du kan teste det ganske simpelt med følgende kommandoer (vist i terminalen). Start terminalen op med <kbd>Ctrl</kbd>+<kbd>Alt</kbd>+<kbd>T</kbd>. <span class="inl_cmd">umask</span>-værdien resetter sig selv efter at den kørende session er lukket ned.</p>

<pre class="ubuntu_terminal">
<span class="green1">thoj@thoj-VirtualBox</span>:<span class="blue1">~</span>$ touch testfile
<span class="green1">thoj@thoj-VirtualBox</span>:<span class="blue1">~</span>$ mkdir testdir
<span class="green1">thoj@thoj-VirtualBox</span>:<span class="blue1">~</span>$ ls -al | grep test
drwxrwxr-x  2 thoj thoj 4096 maj  4 12:55 <span class="red">test</span>dir
-rw-rw-r--  1 thoj thoj    0 maj  4 12:55 <span class="red">test</span>file
<span class="green1">thoj@thoj-VirtualBox</span>:<span class="blue1">~</span>$ umask 077
<span class="green1">thoj@thoj-VirtualBox</span>:<span class="blue1">~</span>$ touch testfile1
<span class="green1">thoj@thoj-VirtualBox</span>:<span class="blue1">~</span>$ mkdir testdir1
<span class="green1">thoj@thoj-VirtualBox</span>:<span class="blue1">~</span>$ ls -al | grep test
drwxrwxr-x  2 thoj thoj 4096 maj  4 12:55 <span class="red">test</span>dir
drwx------  2 thoj thoj 4096 maj  4 12:59 <span class="red">test</span>dir1
-rw-rw-r--  1 thoj thoj    0 maj  4 12:55 <span class="red">test</span>file
-rw-------  1 thoj thoj    0 maj  4 12:59 <span class="red">test</span>file1
</pre>

<p>Her ovenfor kan du se, at de nyoprettede filer ikke har fået rettigheder til gruppe og alle.</p>

<p>Vær opmærksom på at <span class="inl_cmd">umask</span> kun kan begrænse rettigheder og at<span class="inl_cmd">umask</span> ikke kan give flere rettigheder end der er i forvejen. Et hurtigt overblik over anvendte <span class="inl_cmd">umask</span>-værdier og sikkerhed:</p>

<table class="centreret">
	<thead>
		<tr>
			<th>umask-værdi</th>
			<th>Sikkerheds <br/>Niveau</th>
			<th>Mappe tilladelse</th>
			<th>Fil tilladelse</th>
		</tr>
	</thead>
	<tbody>
		<tr>
			<td>022</td>
			<td>Åben</td>
			<td>755</td>
			<td>644</td>
		</tr>
		<tr>
			<td>026</td>
			<td>Moderat</td>
			<td>755</td>
			<td>644</td>
		</tr>
		<tr>
			<td>027</td>
			<td>Moderat</td>
			<td>750</td>
			<td>640</td>
		</tr>
		<tr>
			<td>077</td>
			<td>Lukket</td>
			<td>700</td>
			<td>600</td>
		</tr>
	</tbody>
</table>

<p>Læs mere: <a href="http://www.cyberciti.biz/tips/understanding-linux-unix-umask-value-usage.html" target="_blank">http://www.cyberciti.biz/tips/understanding-linux-unix-umask-value-usage.html</a></p>


<h2>Montering af lokale partitioner</h2>

<p></p>

<ul class="none">
	<li>Montering af ext2/3/4 partitioner</li>
	<li>Montering af NTFS partitioner lokalt</li>
	<li>Montering af ISO filer</li>
	<li>Montering af vfat partitioner lokalt</li>
	
</ul>

<span class="afsnit">Montering af ext2/3/4 partitioner</span>

<p><span class="inl_cmd">ext4</span> er standard filsystemet i Ubuntu og er det simpleste at montere. Det er ikke nødvnendigt at angive filsystemet. Nedestående kommando monterer <span class="inl_cmd">/dev/sdb1</span> på <span class="inl_cmd">/mnt/datadrev</span>.</p>

<code class="cmd">mount /dev/sdb1 /mnt/datadrev</code>

<span class="afsnit">Montering af NTFS partitioner lokalt</span>

<p>For at montere NTFS partitioner anvendes <span class="inl_cmd">ntfs-3g</span> og monteringsmappen er <span class="inl_cmd">/mnt/windows</span>, da vi kun er interesseret i at kigge på windows' systemdrev. Normalt anvendes <span class="inl_cmd">ntfs-3g</span> fremfor <span class="inl_cmd">-t ntfs</span>. Det skyldes at <span class="inl_cmd">ntfs-3g</span> er bedre til at håndtere rettighederne i NTFS.</p>

<code class="cmd">ntfs-3g /dev/sda2 /mnt/windows</code>

<span class="afsnit">Montering af ISO filer</span>

<p>ISO filer er brændt i iso9660 formatet. Nedestående kommando monterer Ubuntudesktop ISO filen i <span class="inl_cmd">/media/ubuntudesktop</span>.</p>

<code class="cmd">mount -o loop -t iso9660 /srv/isofiler/ubuntu-14.04.3-desktop-amd64.iso /media/ubuntudesktop</code>

<p>Læg mærke til <span class="inl_cmd">-o loop</span>. Dette er et "pseudo" enhed - egentlig blot en fil - der får det som er monteret til at opføre sig som en harddisk.</p>

<span class="afsnit">Montering af vfat partitioner lokalt</span>

<p>For at montere vfat anvendes <span class="inl_cmd">-t vfat</span>. Havde vi f.eks. haft et USB drev monteret på systemet ville Linux under opstarten have monteret det som en fysisk disk efter SATA drevene. I vores eksempel som <span class="inl_cmd">/dev/sdb1</span>. Læg mærke til at Linux ikke skelner mellem USB og SATA drev, men "kun" ser på at det er enheder der har et partitionstabel.</p>

<code class="cmd">mount -t vfat /dev/sdb1 /mnt/USB01</code>

<h2>Montering af netværksdrev</h2>

<p><span class="inl_cmd">mount</span> anvendes også til montering af netværksdrev. En væsentlig forskel er, at man ofte har brug for at kunne logge på med sit brugernavn og adgangskode.</p>

<table class="">
	<thead>
		<tr>
			<th></th>
			<th></th>
		</tr>
	</thead>
	<tbody>
		<tr>
			<td>Server IP</td>
			<td>10.0.2.10/24</td>
		</tr>
		<tr>
			<td>Deling</td>
			<td>/srv/backup</td>
		</tr>
		<tr>
			<td>Bruger</td>
			<td>thoj</td>
		</tr>
	</tbody>
</table>

<h3>Montering af NFS shares (Linux)</h3>

<code class="cmd">mount 10.0.2.10:/srv/backup /mnt/backup -o user=thoj</code>

<p>Før du får adgang til NFS-delingen bliver du bedt om at give dit password.</p>

<h3>Montering af SMB shares (Windows shares)</h3>

<p>For at montere SMB/NTFS shares anvendes <span class="inl_cmd">cifs</span> -  <span class="bold">C</span>ommon <span class="bold">I</span>nternet <span class="bold">F</span>ile <span class="bold">S</span>ystem</p>

<p>Herunder er et eksempel på hvordan man montere et SMB share på <span class="inl_cmd">10.0.2.10</span> som hedder <span class="inl_cmd">backup</span>. Det bliver monteret i den lokale mappe <span class="inl_cmd">/mnt/backup</span>, som er oprettet automatisk af SystemrescueCD.</p>

<code class="cmd">mount -t cifs //10.0.2.10/backup /mnt/network</code>

<p>Når man anvender et NTFS share spørges der til ens rettigheder. Derfor vil denne kommando ofte medføre at der spørges til roots password. Er drevet delt så alle har adgang trykker du blot [Enter].</p>

<pre class="ubuntu_terminal">
<span class="green">root@sysresccd</span> <span class="blue1">/root</span>  % mount -t cifs //10.0.2.10/alle /mnt/backup_alle  
Password for root@//10.0.2.10/alle:
</pre>

<p>Hvis drevet er delt med rettigheder skal du medsende dine credentials f.eks:</p>

<code class="cmd">mount -t cifs //10.0.2.10/admin /mnt/backup -o user=thoj,pass=123qwe</code>

<p>Hvis du ikke ønsker at medsende dit password i klartekst, kan du vælge at udelade kodeordet. Mount vil spørge om kodeordet.</p>

<code class="cmd">mount -t cifs //10.0.2.10/admin /mnt/backup -o user=thoj</code>

<pre class="ubuntu_terminal">
<span class="green">root@sysresccd</span> <span class="blue1">/root</span>  % mount -t cifs //10.0.2.10/alle /mnt/backup_alle  -o user=thoj
Password for thoj@//10.0.2.10/alle:
</pre>

<p>Denne metode er på ingen måde sikker, da den ikke er krypteret, og at man sender sine kodeord i klartekst. Men for at forsimple ting kan man blot sørge for at oprette en bruger med begrænsede rettigheder til at udføre disse ting med.</p>

<table class="">
	<thead>
		<tr>
			<th>filsystem</th>
			<th>kommando</th>
		</tr>
	</thead>
	<tbody>
		<tr>
			<td>FAT32</td>
			<td><span class="inl_cmd">-t vfat</span></td>
		</tr>
		<tr>
			<td>NTFS</td>
			<td><span class="inl_cmd">-t ntfs-3g</span></td>
		</tr>
		<tr>
			<td>ext2/3/4</td>
			<td> intet - filsystemet konfigureres automatisk</td>
		</tr>
	</tbody>
</table>

<table class="">
	<thead>
		<tr>
			<th>Netværks share</th>
			<th>Kommando</th>
		</tr>
	</thead>
	<tbody>
		<tr>
			<td>NFTS share</td>
			<td>-t cifs</td>
		</tr>
		<tr>
			<td>nfs</td>
			<td>-t nfs</td>
		</tr>
	</tbody>
</table>

<p>nr. 2 harddisk monteres i computeren, der har en NTFS partition og monteres som <span class="inl_cmd">/media/backup</span></p>

<code class="cmd">mount -t ntfs-3g /dev/sdb1 /media/backup</code>

<p>Hvis harddisken er monteret med ext2/3/4 behøver du ikke angive <span class="inl_cmd">-t *filsystem</span>. Hvis den er FAT32 formateret anvendes <span class="inl_cmd">-t vfat</span></p>

<p>Montering af Windows share "backup" på server 192.168.2.15 som <span class="inl_cmd">/media/windowsbackup</span></p>

<code class="cmd">mount -t cifs //192.168.2.15/backup /mnt/windows -o user=thoj,pass=123qwe</code>

<p>Læg mærke til at password og navn skal angives i klartekst, hvilket er uhensigtsmæssigt. Det kan gøres ved at anvende en "credentialsfile": <a href="https://help.ubuntu.com/community/MountWindowsSharesPermanently#Credentials_File" target="_blank">https://help.ubuntu.com/community/MountWindowsSharesPermanently#Credentials_File</a>.</p>



<h2>Afmontering af filsystemer</h2>

<p>Filsystemer afmonteres med <span class="inl_cmd">umount</span>. Eks:</p>

<code class="cmd">umount /dev/sdb1</code>

<h1>Konfigurering af harddiske på Linux</h1>

<p>For at montere filsystemer permanent på et linux system skal man anvende <span class="inl_cmd">/etc/fstab</span>. Herunder er vist et eksempel som er installeret med følgende konfiguration: </p>

<table class="">
	<thead>
		<tr>
			<th>Partition</th>
			<th>Betegnelse</th>
			<th>Størrelse</th>
			<th>type</th>
			<th>Opstartsflad</th>
			<th>Anvendelse</th>
		</tr>
	</thead>
	<tbody>
		<tr>
			<td>/dev/sda1</td>
			<td>/</td>
			<td>50000Mb (50Gb)</td>
			<td>Primær</td>
			<td>Ja</td>
			<td>System</td>
		</tr>
		<tr>
			<td>/dev/sda2</td>
			<td>Ingen</td>
			<td>4096MB (4GB)</td>
			<td>Primær</td>
			<td>-</td>
			<td>Swap</td>
		</tr>
		<tr>
			<td>/dev/sda3</td>
			<td>/data</td>
			<td>31000MB (31GB)</td>
			<td>Primær</td>
			<td>-</td>
			<td>Data og backup</td>
		</tr>
		<tr>
			<td>Ledig plads</td>
			<td> - </td>
			<td>20,9 GB</td>
			<td> - </td>
			<td> - </td>			
			<td>Linux?</td>
		</tr>
	</tbody>
</table>

<pre class="black">
# /etc/fstab: static file system information.
#
# Use 'blkid' to print the universally unique identifier for a
# device; this may be used with UUID= as a more robust way to name devices
# that works even if disks are added and removed. See fstab(5).
#
# &lt;file system&gt; &lt;mount point&gt;   &lt;type&gt;  &lt;options&gt;       &lt;dump&gt;  &lt;pass&gt;
# / was on /dev/sda1 during installation
UUID=c177c89a-3ad8-4588-a172-3bdd86ccc6df /               ext4    errors=remount-ro 0       1
# /data was on /dev/sda3 during installation
UUID=377113e6-5f83-4153-ac47-8d6dbc98a5cb /data           ext4    defaults        0       2
# swap was on /dev/sda2 during installation
UUID=c4e6f606-e61c-4936-9b6e-73de38ed0b7b none            swap    sw              0       0

</pre>

<p>Hver linie i filen angiver ved hjælp af forskellige parametre hvordan Linux skal anvende dem. Der er 5 parametre der skal sættes.</p>



<span class="afsnit"><span class="inl_cmd">&lt;file system&gt;</span> - Partitionens adresse</span>

<p>Her beskrives hvor filsystemet er monteret. Som det kan ses er det vist ved hjælp af enten en sti eller et UUID (<span class="bold">U</span>niversally <span class="bold">U</span>nique <span class="bold">ID</span>entifier). Det første filsystem er angivet ved hjælp af en sti: <span class="inl_cmd">/dev/mapper/vg01-system</span>. Dette er en sti der læses af LVM (<span class="bold">L</span>ogical <span class="bold">V</span>olume <span class="bold">M</span>anagement), som vil blive gennemgået længere nede. UUID'en angiver en fysisk partition på disken, i dette tilfælde <span class="inl_cmd">/dev/sda1</span>. Ved at anvende UUID'er som monteringspunkt bliver den fysiske harddisk unikt identificeret af systemet, og det vil blive opdaget hvis nogen har skiftet disken ud.</p>

<p>UUID'en er "praktisk" unikt, forstået på den måde at UUID'en bliver dannet i det system det anvendes og at sandsynligheden for at en anden enhed i systemet får samme UUID er ekstrem lille. Du kan finde harddiskenes UUID på dit system ved at anvende kommandoen <span class="inl_cmd">sudo blkid</span>. På ovenstående system giver det:</p>

<pre class="ubuntu_terminal">
thoj@tjmainsrv:~$ sudo blkid
[sudo] password for thoj: 
/dev/sda1: UUID="87cd86f4-194e-47c4-b818-4933534cac7f" TYPE="ext2" 
/dev/sda5: UUID="dX0KXS-UURF-U4b5-GuX7-Gs1X-6UTg-Fdc0JL" TYPE="LVM2_member" 
/dev/mapper/vg01-system: UUID="040d0d5d-fa6d-4020-a295-a76581c365ae" TYPE="ext4" 
/dev/mapper/vg01-home: UUID="6bf7a995-f118-4ddd-8f19-090355f98b61" TYPE="ext4" 
/dev/mapper/vg01-web: UUID="c73aa339-a8f1-4f2f-84eb-2163e976e856" TYPE="ext4" 
/dev/mapper/vg01-data: UUID="bc496005-e62f-49c3-967d-7dc0629c78b1" TYPE="ext4" 
/dev/mapper/vg01-swap: UUID="9753858d-9567-4ff6-9afa-0dfdf49b8248" TYPE="swap" 
thoj@tjmainsrv:~$ 
</pre>

<span class="afsnit"><span class="inl_cmd">&lt;mount point&gt;</span> - Partitionens monteringspunkt</span>

<p>Fortæller hvor på filsystemet partitionen er monteret</p>

<span class="afsnit"><span class="inl_cmd">&lt;type&gt;</span> - Partitionens formatering</span>

<p>Fortæller hvilket filsystem partionen er formateret i.</p>

<span class="afsnit"><span class="inl_cmd">&lt;options&gt;</span> - Partitionens indstillinger</span>

<p>Her er det muligt at angive en række indstillinger for hvordan filsystemet skal opføre sig. På den første partition <span class="inl_cmd">/dev/mapper/vg01-system</span>, hvor roden ligger er det sat til <span class="inl_cmd">errors=remount-ro</span>. Det betyder at hvis computeren opdager en fejl (error) på dette filsystem under boot processen, så vil det blive monteret som skrivebeskyttet. På denne måde sikrer man sig at der ikke bliver skrevet på disken, men at man kan sikre sig de data der er på partitionen. </p>

<span class="afsnit"><span class="inl_cmd">&lt;dump&gt;</span> - Backup</span>

<p><span class="inl_cmd">dump</span> er et program, der undersøger filer på ext filsystemet og bestemmer om der er nogle der skal tages backup af. Bliver i realiteten ikke brugt, hvilket er årsagen til at det har værdien <span class="inl_cmd">0</span>.</p>

<span class="afsnit"><span class="inl_cmd">&lt;pass&gt;</span> - Kontrol af partitionen</span>

<p>Fortæller i hvilken prioritering kontrol af filsystemet har under opstart.</p>



<p>I dette setup er der i alt 6 partitioner, hvoraf de 5 er styres af LVM (<span class="bold">L</span>ogical <span class="bold">V</span>olume <span class="bold">M</span>anagement). I Ubuntu får alle fysiske harddiske en UUID (<span class="bold">U</span>niversally <span class="bold">U</span>nique <span class="bold">ID</span>entifiers).</p>

<h2>Tilføje ny harddisk </h2>

<p>Denne guide er rettet mod LVM, men det kan være godt at vide hvordan man tilføjer nye harddiske til Linux. Anvender man LVM er det kun trin 1 der skal udføres, da resten skal gøres i LVM. Dette vil blive gennemgået senere.</p>

<ol class="">
	<li>Konfiguration af harddisken med <span class="inl_cmd">fdisk</span></li>
	<li>Formatering af disken</li>
	<li>Konfiguration af <span class="inl_cmd">/etc/fstab</span></li>
</ol>

<h3>Konfiguration af harddisken med <span class="inl_cmd">fdisk</span></h3>

<p>Først skabes et overblik med <span class="inl_cmd">lsblk</span>. Herunder er outputtet fra ovenstående konfiguration isat en ny 100GB SATA disk</p>

<pre class="ubuntu_terminal">
<span class="green1">thoj@thoj-VirtualBox</span>:<span class="blue1">~</span>$ lsblk
NAME   MAJ:MIN RM  SIZE RO TYPE MOUNTPOINT
sda      8:0    0  100G  0 disk 
├─sda1   8:1    0 46,6G  0 part /
├─sda2   8:2    0  3,8G  0 part [SWAP]
└─sda3   8:3    0 28,9G  0 part /data
sdb      8:16   0  100G  0 disk 
sr0     11:0    1 1024M  0 rom 
</pre>

<p>Kør fdisk</p>

<code class="cmd">fdisk /dev/sdb</code>

<pre class="ubuntu_terminal">
<span class="green1">thoj@thoj-VirtualBox</span>:<span class="blue1">~</span>$ sudo fdisk /dev/sdb
[sudo] adgangskode for thoj: 

<span class="green">Welcome to fdisk (util-linux 2.27.1).</span>
Changes will remain in memory only, until you decide to write them.
Be careful before using the write command.

Device does not contain a recognized partition table.
Created a new DOS disklabel with disk identifier 0x0da5ea98.

Kommando (m for hjælp):
</pre>

<p>Ved at trykke <kbd>m</kbd> får man menuen frem:</p>

<pre class="black">
Help:

<span class="bold">  DOS (MBR)</span>
   a   toggle a bootable flag
   b   edit nested BSD disklabel
   c   toggle the dos compatibility flag

<span class="bold">  Generic</span>
   d   delete a partition
   F   list free unpartitioned space
   l   list known partition types
   n   add a new partition
   p   print the partition table
   t   change a partition type
   v   verify the partition table
   i   print information about a partition

<span class="bold">  Misc</span>
   m   print this menu
   u   change display/entry units
   x   extra functionality (experts only)

<span class="bold">  Script</span>
   I   load disk layout from sfdisk script file
   O   dump disk layout to sfdisk script file

<span class="bold">  Save & Exit</span>
   w   write table to disk and exit
   q   quit without saving changes

<span class="bold">  Create a new label</span>
   g   create a new empty GPT partition table
   G   create a new empty SGI (IRIX) partition table
   o   create a new empty DOS partition table
   s   create a new empty Sun partition table


Kommando (m for hjælp): 
</pre>

<p>Før vi gør noget andet skal vi lige tjekke om vi har den rigtige harddisk. Tast <kbd>p</kbd></p>

<pre class="black">
Kommando (m for hjælp): p
<span class="bold">Disk /dev/sdb: 100 GiB, 107374182400 bytes, 209715200 sectors</span>
Units: sectors of 1 * 512 = 512 bytes
Sector size (logical/physical): 512 bytes / 512 bytes
I/O size (minimum/optimal): 512 bytes / 512 bytes
Disklabel type: dos
Disk identifier: 0xc0b6b3c8
</pre>

<p>Lær mærke til linien der er med fed skrift. Herefter skal der gøres er følgende:</p>

<table class="">
	<thead>
		<tr>
			<th>Trin</th>
			<th>Input</th>
			<th>Forklaring</th>
		</tr>
	</thead>
	<tbody>
		<tr>
			<th>1</th>
			<td><kbd>m</kbd></td>
			<td>* Vis alle kommandoerne</td>
		</tr>
		<tr>
			<th>2</th>
			<td><kbd>n</kbd></td>
			<td>Opret ny partition</td>
		</tr>
		<tr>
			<th>3</th>
			<td><kbd>p</kbd></td>
			<td>Den skal være primær</td>
		</tr>
		<tr>
			<th>4</th>
			<td><kbd>Enter</kbd></td>
			<td>Du skal vælger første partition – [Enter gør det som standard]</td>
		</tr>
		<tr>
			<th>5</th>
			<td><kbd>Enter</kbd></td>
			<td>Du skal vælge første sektor – [Enter gør det som standard]</td>
		</tr>
		<tr>
			<th>6</th>
			<td><kbd>Enter</kbd></td>
			<td>Du skal vælge sidste sektor – [Enter gør det som standard]</td>
		</tr>
		<tr>
			<th>7</th>
			<td><kbd>p</kbd></td>
			<td>* Tjek partionstabellen</td>
		</tr>
		<tr>
			<th>8</th>
			<td><kbd>w</kbd></td>
			<td>Skriv ændringerne til disken</td>
		</tr>
	</tbody>
</table>

<pre class="black">
Kommando (m for hjælp): <span class="red">n [ENTER]</span> 
Partition type
   p   primary (0 primary, 0 extended, 4 free)
   e   extended (container for logical partitions)
Select (default p): <span class="red">p [ENTER]</span>
Partitionsnummer (1-4, default 1): <span class="red">[ENTER]</span>
First sector (2048-209715199, default 2048): <span class="red">[ENTER]</span>
Last sector, +sectors or +size{K,M,G,T,P} (2048-209715199, default 209715199): <span class="red">[ENTER]</span>

Created a new partition 1 of type 'Linux' and of size 100 GiB.

Kommando (m for hjælp): <span class="red">p [ENTER]</span>
<span class="bold">Disk /dev/sdb: 100 GiB, 107374182400 bytes, 209715200 sectors</span>
Units: sectors of 1 * 512 = 512 bytes
Sector size (logical/physical): 512 bytes / 512 bytes
I/O size (minimum/optimal): 512 bytes / 512 bytes
Disklabel type: dos
Disk identifier: 0xc0b6b3c8

<span class="bold">Enhed      Opstart Start      Slut  Sektorer  Size Id Type</span>
/dev/sdb1           2048 209715199 209713152  100G 83 Linux

Kommando (m for hjælp): <span class="red">w [ENTER]</span>
The partition table has been altered.
Calling ioctl() to re-read partition table.
Syncing disks.
</pre>

<p>Som vi kan se herover bliver harddisken som standard sat til Id/Type 83/Linux, og harddisken er sat korrekt op.</p>

<h2>Ændring af ID/Type</h2>

<p>Her overfor er harddisken sat op til et Linux-filsystem. Ønsker du at sætte den op til et andet filsystem (f.eks. NTFS) kan du gøre det ved at køre <span class="inl_cmd">fdisk</span> igen - eller gøre det efter trin 7 før du skriver til disken.</p>

<code class="cmd">sudo fdisk /dev/sdb</code>

<p>Herefter skal der vælges system-ID, som passer til det filsystem der skal anvendes. De mest anvendte er:</p>

<table class="">
	<thead>
		<tr>
			<th>Kode</th>
			<th>Filsystem</th>
			<th>Anvendelse</th>
		</tr>
	</thead>
	<tbody>
		<tr>
			<td>7</td>
			<td>HPFS/NTFS/exFAT</td>
			<td>Windows 7/8/10</td>
		</tr>
		<tr>
			<td>c</td>
			<td>95 FAT32 (LBA)</td>
			<td>USB drev</td>
		</tr>
		<tr>
			<td>83</td>
			<td>Linux</td>
			<td>ext 2/3/4</td>
		</tr>
		<tr>
			<td>8e</td>
			<td>LINUX LVM</td>
			<td>LVM partitioner</td>
		</tr>
	</tbody>
</table>

<p>Herunder vil vi ændre partitionen til NTFS</p>

<table class="">
	<thead>
		<tr>
			<th>Trin</th>
			<th>Input</th>
			<th>Forklaring</th>
		</tr>
	</thead>
	<tbody>
		<tr>
			<th>1</th>
			<td><kbd>p</kbd></td>
			<td>Tjek partionstabellen</td>
		</tr>
		<tr>
			<th>2</th>
			<td><kbd>l</kbd></td>
			<td>Få et overblik over tilgængelige filsystemer</td>
		</tr>
		<tr>
			<th>3</th>
			<td><kbd>t</kbd></td>
			<td>Aktivier prompten til at vælge ID</td>
		</tr>
		<tr>
			<th>4</th>
			<td><kbd>7</kbd></td>
			<td>Vælg NTFS</td>
		</tr>
		<tr>
			<th>5</th>
			<td><kbd>p</kbd></td>
			<td>Tjek partionstabellen</td>
		</tr>
		<tr>
			<th>6</th>
			<td><kbd>w</kbd></td>
			<td>Skriv ændringerne til disken</td>
		</tr>
	</tbody>
</table>


<p>Angående filsystem ID kan man få et overblik frem med <span class="inl_cmd">l</span>:</p>

<pre class="black">
Kommando (m for hjælp): <span class="red">p [Enter]</span>
<span class="bold">Disk /dev/sdb: 100 GiB, 107374182400 bytes, 209715200 sectors</span>
Units: sectors of 1 * 512 = 512 bytes
Sector size (logical/physical): 512 bytes / 512 bytes
I/O size (minimum/optimal): 512 bytes / 512 bytes
Disklabel type: dos
Disk identifier: 0xc0b6b3c8

<span class="bold">Enhed      Opstart Start      Slut  Sektorer  Size Id Type</span>
/dev/sdb1           2048 209715199 209713152  100G 83 Linux

Kommando (m for hjælp): <span class="red">l [Enter]</span>

 0  Tom             24  NEC DOS         81  Minix / gammel  bf  Solaris        
 1  FAT12           27  Hidden NTFS Win 82  Linux swap / So c1  DRDOS/sec (FAT-
 2  XENIX root      39  Plan 9          83  Linux           c4  DRDOS/sec (FAT-
 3  XENIX usr       3c  PartitionMagic  84  OS/2 hidden or  c6  DRDOS/sec (FAT-
 4  FAT16 &lt;32M      40  Venix 80286     85  Linux udvidet   c7  Syrinx         
 5  Udvidet         41  PPC PReP Opstar 86  NTFS diskenheds da  Ikke-filsystemd
 6  FAT16           42  SFS             87  NTFS diskenheds db  CP/M / CTOS / .
 7  HPFS/NTFS/exFAT 4d  QNX4.x          88  Linux råtekst   de  Dell-værktøj   
 8  AIX             4e  QNX4.x 2. part  8e  Linux LVM       df  BootIt         
 9  AIX opstartbar  4f  QNX4.x 3. part  93  Amoeba          e1  DOS access     
 a  OS/2-opstartshå 50  OnTrack DM      94  Amoeba BBT      e3  DOS R/O        
 b  W95 FAT32       51  OnTrack DM6 Aux 9f  BSD/OS          e4  SpeedStor      
 c  W95 FAT32 (LBA) 52  CP/M            a0  IBM Thinkpad dv ea  Rufus alignment
 e  W95 FAT16 (LBA) 53  OnTrack DM6 Aux a5  FreeBSD         eb  BeOS fs        
 f  W95 udvidet (LB 54  OnTrackDM6      a6  OpenBSD         ee  GPT            
10  OPUS            55  EZ-Drev         a7  NeXTSTEP        ef  EFI (FAT-12/16/
11  Skjult FAT12    56  Golden Bow      a8  Darwin UFS      f0  Linux/PA-RISC o
12  Compaq diagnost 5c  Priam Edisk     a9  NetBSD          f1  SpeedStor      
14  Skjult FAT16 &lt;3 61  SpeedStor       ab  Darwin opstart  f4  SpeedStor      
16  Skjult FAT16    63  GNU HURD eller  af  HFS / HFS+      f2  DOS sekundær   
17  Skjult HPFS/NTF 64  Novell Netware  b7  BSDI fs         fb  VMware VMFS    
18  AST SmartSleep  65  Novell Netware  b8  BSDI swap       fc  VMware VMKCORE 
1b  Skjult W95 FAT3 70  DiskSecure Mult bb  Boot Wizard skj fd  Linux raid auto
1c  Skjult W95 FAT3 75  PC/IX           bc  Acronis FAT32 L fe  LANstep        
1e  Skjult W95 FAT1 80  Gammel Minix    be  Solaris opstart ff  BBT            

Kommando (m for hjælp): <span class="red">t [Enter]</span>
Selected partition 1
Partition type (type L to list all types): 7
Changed type of partition 'Linux' to 'HPFS/NTFS/exFAT'.

Kommando (m for hjælp): <span class="red">p [Enter]</span>
<span class="bold">Disk /dev/sdb: 100 GiB, 107374182400 bytes, 209715200 sectors</span>
Units: sectors of 1 * 512 = 512 bytes
Sector size (logical/physical): 512 bytes / 512 bytes
I/O size (minimum/optimal): 512 bytes / 512 bytes
Disklabel type: dos
Disk identifier: 0xc0b6b3c8

<span class="bold">Enhed      Opstart Start      Slut  Sektorer  Size Id Type</span>
/dev/sdb1           2048 209715199 209713152  100G  7 HPFS/NTFS/exFAT

Kommando (m for hjælp): <span class="red">w [Enter]</span>
The partition table has been altered.
Calling ioctl() to re-read partition table.
Syncing disks.
</pre>

<p>Efter partitioneringen af disken fås følgende output af <span class="inl_cmd">fdisk -l</span></p>

<pre class="ubuntu_terminal">
<span class="green1">thoj@thoj-VirtualBox</span>:<span class="blue1">~</span>$ sudo fdisk -l /dev/sdb
<span class="bold">Disk /dev/sdb: 100 GiB, 107374182400 bytes, 209715200 sectors</span>
Units: sectors of 1 * 512 = 512 bytes
Sector size (logical/physical): 512 bytes / 512 bytes
I/O size (minimum/optimal): 512 bytes / 512 bytes
Disklabel type: dos
Disk identifier: 0xc0b6b3c8

<span class="bold">Enhed      Opstart Start      Slut  Sektorer  Size Id Type</span>
/dev/sdb1           2048 209715199 209713152  100G  7 HPFS/NTFS/exFAT
 
</pre>

<p><span class="red">NOTE: </span>For at fortsætte guiden skal du ændre harddisken tilbage til et Linux Filsystem (83). Kontroller med <span class="inl_cmd">fdisk -l /dev/sdb</span>.</p>

<h2>Formatering af disken</h2>

<p>Linux har mange forskellige filsystemer, hvor <span class="inl_cmd">ext2</span> og <span class="inl_cmd">ext4</span> er det mest almindelige. Herunder er det vist hvordan man formaterer de forskellige filsystemer:</p>

<table class="">
	<thead>
		<tr>
			<th>Filsystem</th>
			<th>Formatering</th>
			<th>Kontrol</th>
		</tr>
	</thead>
	<tbody>
		<tr>
			<td>ext2</td>
			<td><span class="inl_cmd">mkfs.ext2 *partition*</span></td>
			<td><span class="inl_cmd">e2fsck *partition*</span></td>
		</tr>
		<tr>
			<td>ext4</td>
			<td><span class="inl_cmd">mkfs.ext4 *partitioner*</span></td>
			<td><span class="inl_cmd">e2fsck *partition*</span></td>
		</tr>
		<tr>
			<td>vfat</td>
			<td><span class="inl_cmd">mkfs.vfat *partitioner*</span></td>
			<td><span class="inl_cmd">fsck.vfat *partition*</span></td>
		</tr>
		<tr>
			<td>NTFS</td>
			<td><span class="inl_cmd">mkfs.ntfs *partitioner*</span></td>
			<td> - </td>
		</tr>

	</tbody>
</table>

<p>Herunder formaterer vi harddisken til ext4:</p>

<code class="cmd">sudo mkfs.ext4 /dev/sdb1</code>

<pre class="ubuntu_terminal">
<span class="green1">thoj@thoj-VirtualBox</span>:<span class="blue1">~</span>$ sudo mkfs.ext4 /dev/sdb1
mke2fs 1.42.13 (17-May-2015)
Opretter filsystem med 26214144 4k blokke og 6553600 iknuder
Filsystem UUID: 432a02a0-2e49-4b52-b19c-e68db62baf51
Superblock backups stored on blocks: 
	32768, 98304, 163840, 229376, 294912, 819200, 884736, 1605632, 2654208, 
	4096000, 7962624, 11239424, 20480000, 23887872

Allokerer gruppetabeller: færdig                          
Skriver iknudetabeller: færdig                          
Opretter journal (32768 blokke): færdig
Skriver superblokke og filsystemets registreringsinformation: færdig 

</pre>


<h2>Fast montering af disken</h2>

<p>I første kapitel gennemgik vi hvordan man mounter partitioner. Herunder vil vi gøre sådan at harddisken automatisk bliver monteret når computeren starter op. Vi vil montere mappen i <span class="inl_cmd">/srv/newdisk</span>, da <span class="inl_cmd">/srv</span> er standardmappen for datadiske. Først vil vi tjekke harddisken og dens opsætning og herefter oprette mappen:</p>

<code class="cmd">sudo fdisk -l /dev/sdb</code>
<code class="more_cmd">sudo mkdir -p /srv/newdisk</code>

<pre class="ubuntu_terminal">
<span class="green1">thoj@thoj-VirtualBox</span>:<span class="blue1">~</span>$ sudo fdisk -l /dev/sdb
<span class="bold">Disk /dev/sdb: 100 GiB, 107374182400 bytes, 209715200 sectors</span>
Units: sectors of 1 * 512 = 512 bytes
Sector size (logical/physical): 512 bytes / 512 bytes
I/O size (minimum/optimal): 512 bytes / 512 bytes
Disklabel type: dos
Disk identifier: 0xc0b6b3c8

<span class="bold">Enhed      Opstart Start      Slut  Sektorer  Size Id Type</span>
/dev/sdb1           2048 209715199 209713152  100G 83 Linux
<span class="green1">thoj@thoj-VirtualBox</span>:<span class="blue1">~</span>$ sudo mkdir -p /srv/newdisk
</pre>

<p>For at kunne montere disken ved hjælp af <span class="inl_cmd">/etc/fstab</span>, så den også er monteret herefter skal vi finde diskens UUID og indsætte denne linie 8 <span class="inl_cmd">/etc/fstab</span>.</p>

<code class="cmd">sudo blkid | grep /dev/sdb1</code>

<pre class="ubuntu_terminal">
<span class="green1">thoj@thoj-VirtualBox</span>:<span class="blue1">~</span>$ sudo blkid | grep /dev/sdb1
<span class="red">/dev/sdb1</span>: UUID="a9325cdc-bd8b-4795-b514-59f1f7453235" TYPE="ext4" PARTUUID="c0b6b3c8-01"
</pre>

<p>Følgende linier indsættes i <span class="inl_cmd">/etc/fstab</span> (husk at fjerne " om UUID'en):</p>

<code class="cmd">sudo nano /etc/fstab</code>

<pre class="black">
#/srv/newdisk er indsat i filsystemet af thoj 17082015
UUID=a9325cdc-bd8b-4795-b514-59f1f7453235  /srv/newdisk   ext4	defaults       0   2
</pre>

<p>Herefter vil harddisken være monteret i <span class="inl_cmd">/srv/newdisk</span> efter opstart. For at mountere disken med det samme anvendes <span class="inl_cmd">mount</span> kommandoen med et <span class="inl_cmd">-a</span> bagefter. Den får Ubuntu til at genindlæse <span class="inl_cmd">/etc/fstab</span> og sørge for at alle partitioner der er nævnt deri bliver monteret. Herunder er det vist ved hjælp af <span class="inl_cmd">lsblk</span>.</p>

<pre class="ubuntu_terminal">
<span class="green1">thoj@thoj-VirtualBox</span>:<span class="blue1">~</span>$ lsblk
NAME   MAJ:MIN RM  SIZE RO TYPE MOUNTPOINT
sda      8:0    0  100G  0 disk 
├─sda1   8:1    0 46,6G  0 part /
├─sda2   8:2    0  3,8G  0 part [SWAP]
└─sda3   8:3    0 28,9G  0 part /data
sdb      8:16   0  100G  0 disk 
└─sdb1   8:17   0  100G  0 part <span class="red">&lt;-- Læg mærke til denne linie </span>
sr0     11:0    1 1024M  0 rom  
<span class="green1">thoj@thoj-VirtualBox</span>:<span class="blue1">~</span>$ sudo mount -a <span class="red">Alle drev monteres</span>
<span class="green1">thoj@thoj-VirtualBox</span>:<span class="blue1">~</span>$ lsblk
NAME   MAJ:MIN RM  SIZE RO TYPE MOUNTPOINT
sda      8:0    0  100G  0 disk 
├─sda1   8:1    0 46,6G  0 part /
├─sda2   8:2    0  3,8G  0 part [SWAP]
└─sda3   8:3    0 28,9G  0 part /data
sdb      8:16   0  100G  0 disk 
└─sdb1   8:17   0  100G  0 part /srv/newdisk <span class="red">&lt;-- Læg mærke til denne linie </span>
sr0     11:0    1 1024M  0 rom  
</pre>

<h2>Kontrol af harddiske</h2>

<p>Ubuntu kører normalt med <span class="inl_cmd">ext4</span>-filsystem, og det kan man kontrollere med <span class="inl_cmd">e2fsck</span>. Kommandoen skal køres mens partitionen ikke er monteret. Det betyder at hvis man vil kontrollere rod-drevet, så skal computeren genstartes med en live linuxdistribution som f.eks. SystemrescueCD (<a href="https://www.system-rescue-cd.org/Download" target="_blank">https://www.system-rescue-cd.org/Download</a>). Fordelen ved at anvende den fremfor Ubuntu selv er, at SystemrescueCD ikke mounter nogle drev.</p>

<p>Herunder har jeg afmonteret <span class="inl_cmd">/data</span> (<span class="inl_cmd">/dev/sda3)</span> på min testmaskine og lavet et filcheck på den:</p>

<pre class="ubuntu_terminal">
<span class="green1">thoj@thoj-VirtualBox</span>:<span class="blue1">~</span>$ sudo umount /dev/sda3
<span class="green1">thoj@thoj-VirtualBox</span>:<span class="blue1">~</span>$ sudo e2fsck /dev/sda3
e2fsck 1.42.13 (17-May-2015)
/dev/sda3: ren, 11/1892352 filer, 162783/7568384 blokke
<span class="green1">thoj@thoj-VirtualBox</span>:<span class="blue1">~</span>$ sudo mount -a
</pre>

<p>Den sidste kommando undersøger <span class="inl_cmd">/etc/fstab</span> og genmonterer de partitioner der ikke er monteret.</p>

<h3>Hvor meget plads er der?</h3>

<p>For at finde ud af hvor meget plads der er tilgængelig på systemet anvendes kommandoen <code class="cmd">df -h</code></p>

<pre class="ubuntu_terminal">
<span class="green1">thoj@thoj-VirtualBox</span>:<span class="blue1">~</span>$ df -h
Filsystem      Størr Brugt  Tilb Brug% Monteret på
udev            2,0G     0  2,0G    0% /dev
tmpfs           396M  6,1M  390M    2% /run
/dev/sda1        46G  3,9G   40G    9% /
tmpfs           2,0G  216K  2,0G    1% /dev/shm
tmpfs           5,0M  4,0K  5,0M    1% /run/lock
tmpfs           2,0G     0  2,0G    0% /sys/fs/cgroup
/dev/sda3        29G   44M   27G    1% /data
tmpfs           396M   52K  396M    1% /run/user/1000
/dev/sdb1        99G   60M   94G    1% /srv/newdisk
</pre>

<p>Hvis man har lavet ændringer på en harddisk med <span class="inl_cmd">fdisk</span>, så kan man risikere, at kernen ikke kan arbejde med de nye informationer. Det kan løses enten ved at genstarte maskinen, eller at anvende programmet <span class="inl_cmd">partprobe</span>.</p>

<code class="cmd">partprobe</code>



	
</div><!-- end: col-md-9 -->

<footer>

	<p><a rel="license" href="http://creativecommons.org/licenses/by-nc-sa/4.0/"><img alt="Creative Commons licens" src="https://i.creativecommons.org/l/by-nc-sa/4.0/88x31.png" /></a>Indholdet på Vidas.dk er  er licenseret under <a rel="license" href="http://creativecommons.org/licenses/by-nc-sa/4.0/">CC BY-NC-SA 4.0</a> og er skrevet af Thomas Jensen. (<a href="../hvem_er_jeg.html" target="_blank">Læs mere</a>)</p>

</footer>
	
	
</div><!-- end: row-fluid -->

</div> <!-- end: container-fluid -->


<!-- SCRIPT SECTION -->
<script type="text/javascript" src="../js/jquery.min.js"></script>
<script type="text/javascript" src="../js/jquery-ui.min.js"></script>
<script type="text/javascript" src="../js/jquery.tocify.min.js"></script>
<script type="text/javascript" src="../js/bootstrap.min.js"></script>

<!-- PRETTYFY-->
<script src="https://cdn.rawgit.com/google/code-prettify/master/loader/run_prettify.js"></script>


<!-- HIGHLIGHT -->
	<script src="../js/highlight.pack.js" type="text/javascript"></script>
	<script>hljs.initHighlightingOnLoad();</script>

<!-- MATHJAX -->
<script type="text/javascript" async 		src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-MML-AM_CHTML">
		MathJax.Hub.Config({ jax: ["input/TeX","output/HTML-CSS"], displayAlign: "left"	});
</script>
<!-- TOCIFY -->
<script>
	$(function() {var toc = $("#toc").tocify({ selectors: "h1, h2, h3, h4" }).data("toc-tocify"); });
</script>
<!-- GOOGLE ANALYTICS -->
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-89933285-1', 'auto');
  ga('send', 'pageview');
</script>

</body>
</html>
