<!DOCTYPE html>
<html lang="da">
<head>
  <title>Vidas.dk</title>
  <link rel="icon" href="../images/favicon.png">
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  
  <link href='http://fonts.googleapis.com/css?family=Ubuntu+Mono|Ubuntu|Ubuntu+Condensed' rel='stylesheet' type='text/css'>

  <link rel="stylesheet" href="../css/bootstrap.min.css">
  <link rel="stylesheet" href="../css/jquery-ui.min.css">
  <link rel="stylesheet" href="../css/jquery.tocify.css">
  <link rel="stylesheet" href="../css/style_new.css" />
<!-- Scripts in bottom to speed up pageload-->
 

</head>
<body>
	
	
<div class="container-fluid">

<div class="row-fluid">
	
<div class="col-xs-3">
	
	<div id="toc">
	
		<div id="toc_headline"></div>
	
	</div>

</div><!-- Start slut 1. kolonne - TOC -->
	
<div class="col-xs-9">
	
<div class="title">MySQL - CSV</div>

<blockquote>
	<p>Det er vigtigt at du anvender <span class="inl_cmd">Chrome</span> eller <span class="inl_cmd">Firefox</span> til disse opgaver, da PHPMyAdmin følger webstandarderne. Hvis du anvender Safari, Internet Explorer eller Edge, risikerer du at få fejl.</p>
</blockquote>

<h1>Comma Separated Values</h1>

<p>Skal man indtaste meget data kan det betale sig at anvende <abbr title="Comma-Separated Values">csv</abbr> filer. Det er filer hvor man ved hjælp af simple tekstfiler kan indtaste store mængder data. Se eksemplet f.eks. tabellen herunder:</p>

<table class="">
	<thead>
		<tr>
			<th>Initialer</th>
			<th>f_Navn</th>
			<th>e_navn</th>
			<th>Mobil</th>
			<th>Mail</th>
		</tr>
	</thead>
	<tbody>
		<tr>
			<td>bs1</td>
			<td>Anders</td>
			<td>Andersen</td>
			<td>23344556</td>
			<td>aa@fakemail.dk</td>
		</tr>
		<tr>
			<td>bs2</td>
			<td>Bente</td>
			<td>bentsen</td>
			<td>23344557</td>
			<td>bb@fakemail.dk</td>
		</tr>
		<tr>
			<td>bs3</td>
			<td>Carl</td>
			<td>Carlsen</td>
			<td>23344558</td>
			<td>cc@fakemail.dk</td>
		</tr>
		<tr>
			<td>bs4</td>
			<td>Dorte</td>
			<td>Dotsen</td>
			<td>23344559</td>
			<td>dd@fakemail.dk</td>
		</tr>
		<tr>
			<td>bs5</td>
			<td>Egon</td>
			<td>Egonsen</td>
			<td>23344560</td>
			<td>ee@fakemail.dk</td>
		</tr>
		<tr>
			<td>bs6</td>
			<td>Frederikke</td>
			<td>Frederiksen</td>
			<td>23344561</td>
			<td>ff@fakemail.dk</td>
		</tr>
	</tbody>
</table>

<p>Det kan man skrive ind i en tekstfil, ved at lade rækkerne være adskilt af linjeskift og kolonnerne af kommaer (<span class="inl_cmd">,</span>). Læg mærke til at den første række indeholder kolonne navnene.</p>


<pre class="black">initialer,f_navn,e_navn,Mobil,Mail 
bs1,Anders,Andersen,23344556,aa@fakemail.dk 
bs2,Bente,bentsen,23344557,bb@fakemail.dk
bs3,Carl,Carlsen,23344558,cc@fakemail.dk
bs4,Dorte,Dotsen,23344559,dd@fakemail.dk
bs5,Egon,Egonsen,23344560,ee@fakemail.dk
bs6,Frederikke,Frederiksen,23344561,ff@fakemail.dk</pre>

<p>Du kan hente denne lille csv fil her: <a href="files/bestyrelse_csv.csv" download>bestyrelse_csv.csv</a>.</p>

<blockquote>

<p>Man skal være opmærksom på at CSV ikke er en fast standard, og at man ikke kan være sikker på at det er kommaer der adskiller de enkelte felter.</p>

<p>Microsoft anvender f.eks. semikolon (<span class="inl_cmd">;</span>) som separator, og det betyder at man skal gøre programmet opmærksom på at det ikke er komma der separerer. Der kommer et eksempel på dette lidt senere
</p>

</blockquote>

<h1>Importer CSV-fil</h1>


<p>Man kan importere <span class="inl_cmd">csv</span>-filer ved at vælge sin database og vælge menuen <span class="inl_cmd">Importer</span>. Vælg databasen <span class="inl_cmd">mentorer</span> og herefter menuen <span class="inl_cmd">Importer</span>.</p>

<p>Klik på knappen <span class="knap">Vælg fil</span> og find filen <span class="inl_cmd">bestyrelse_csv.csv</span></p>

<figure id="">

	<img class="p90" src="images/mysel_import_csv01.png" alt="" title="" />

	<figcaption></figcaption>

</figure>

<p>Når den er valgt skal du sætte formatet til <span class="inl_cmd">CSV</span> og sætte flueben i "<span class="inl_cmd">Den første linje af filen indeholder tabellens kolonnenavne</span>"</p>

<figure id="">

	<img class="p90" src="images/mysel_import_csv02.png" alt="" title="" />

	<figcaption></figcaption>

</figure>

<p>Herefter kan du trykke <span class="knap">Udfør</span></p>

<p>Når databasen er lagt ind kan du se den nye tabel ved at klikke på menuen <span class="inl_cmd">Struktur</span>:</p>

<figure id="">

	<img class="p90" src="images/mysel_import_csv03.png" alt="" title="" />

	<figcaption></figcaption>

</figure>

<p>Vi skal lige have ændret navnet på tabellen, og det gør vi ved at klikke på tabellen <span class="inl_cmd">Table 4</span> og vælge menuen <span class="inl_cmd">Operationer</span> (du skal måske kigge under menuen <span class="inl_cmd">Mere</span>). Her ændrer vi navnet til <span class="inl_cmd">bestyrelse</span>.  </p>

<figure id="">

	<img class="p90" src="images/mysel_import_csv04.png" alt="" title="" />

	<figcaption></figcaption>

</figure>

<p>Klik på <span class="knap">Udfør</span>, og se resultatet ved at vælge hele databasen igen og se resultatet:</p>

<figure id="">

	<img class="p90" src="images/mysel_import_csv05.png" alt="" title="" />

	<figcaption></figcaption>

</figure>

<p>Som det sidste ændrer posten <span class="inl_cmd">initialer</span> til at være primærnøgle for tabellen.</p>

<figure id="">

	<img class="p90" src="images/mysel_import_csv06.png" alt="" title="" />

	<figcaption></figcaption>

</figure>

<p>Læg mærke til at længderne af datatyperne er sat efter <span class="inl_cmd">csv</span>-filen. Det kan være nødvendigt at justere på datatyperne og/eller længderne af dem, hvis der senere skal ændres i listen.</p>

<h1>Importer postnumre</h1>

<p>Her vil vi importere de danske postnumre. Oprindeligt kommer tabellen fra <a href="http://www.postnord.dk/da/Privat/Kundeservice/postnummerkort/Sider/postnummerkort.aspx" target="_blank">Postnord's hjemmeside</a>, men til denne opgave har jeg omdannet den til <span class="inl_cmd">csv</span>-format.</p>

<p>Hent filen <a href="files/postnummerfil.csv" download>postnummerfil.csv</a> og importer den i en database.</p>

<blockquote>
	<p>
		Ofte får man leveret datafiler i excel-format. Det kræver at man i Excel gemmer filen i <span class="inl_cmd">csv</span>-format. Du skal være opmærksom på at Microsoft ikke gemmer filen korrekt, men med semikolonner (<span class="inl_cmd">;</span>) i stedet for kommaer (<span class="inl_cmd">,</span>).				
	</p>
	<p>
		Derfor skal du ændre feltet "<span class="inl_cmd">Kolonner adskilt med:</span>" fra <span class="inl_cmd">,</span> til <span class="inl_cmd">;</span>.
	</p>
</blockquote>

<p>Når du importeret tabellen skal du vælge menuen <span class="inl_cmd">Vis</span>:</p>

<figure id="">

	<img class="p90" src="images/mysql_import_postnummer_csv_03.png" alt="" title="" />

	<figcaption></figcaption>

</figure>

<p>Læg mærke til at phpMyAdmin kommer med en advarsel: "Current selection does not contain a unique column". Tabellen har altså ikke en PRIMÆR nøgle, og det betyder, at vi ikke kan rette, kopiere og slette i tabellen. Det skal vi have ændret. Gå ind i menuen <span class="inl_cmd">Struktur</span> og sæt <span class="inl_cmd">Postnr.</span> til at være PRIMÆR nøgle. Læg mærke til at det udløser en fejl.</p>

<figure id="">

	<img class="p30" src="images/mysql_import_postnummer_csv_04.png" alt="" title="" />

	<figcaption></figcaption>

</figure>

<p>Årsagen hertil er, at bl.a. postnummeret 1055 forekommer mere end en gang, hvilket betyder at feltet ikke kan være en primærnøgle. Det betyder enten:</p>

<ol class="">
	<li>... at vi må rette og ændre i tabellen manuelt for at fjerne dubletter af postnumre.</li>
	<li>... at vi må oprette en "<span class="inl_cmd">mange-til-mange</span>" relation.</li>
	<li>... at vi vælger at leve med, at denne tabel ikke har en primærnøgle.</li>
</ol>

<p>I dette tilfælde vælger vi den 3. mulighed, og det kan vi gøre fordi det ikke er en tabel vi vedligeholder og skal rette i, men at den kommer fra Postnord.</p>

<p>Som det sidste ændrer vi tabellens navn til "<span class="inl_cmd">postnr</span>" ved at gå ind i menuen <span class="inl_cmd">Operationer</span> og blokken <span class="inl_cmd">Tabel-indstillinger</span>.</p>

<h1>Flere databaser</h1>
	
<p>På nettet findes der flere fri databaser der er tilgængelige i CSV format. Prøv f.eks. denne: <a href="https://think.cs.vt.edu/corgis/csv/index.html" target="_blank">https://think.cs.vt.edu/corgis/csv/index.html</a></p>

<p>Her finder man f.eks. en musikdatabase: <a href="https://think.cs.vt.edu/corgis/csv/music/music.html" target="_blank">https://think.cs.vt.edu/corgis/csv/music/music.html</a></p>

<p>Disse databaser kan være ret store, og det betyder at der skal ændres på standardindstillingerne i XAMPP. Helt konkret skal vi have ændret på størrelsen af de filer, som PHPMyAdmin vil acceptere. For at undgå at komme i problemer med størrelsen sætter vi den til 100MB. </p>

<span class="afsnit">... på Windows</span>

<p>Start Geany og åbn filen <span class="inl_cmd">php.ini</span> i mappen <span class="inl_cmd">C:\xampp\php</span>, og indsæt følgende i bunden.</p>

<pre class="black">
post_max_size = 100M 
upload_max_filesize = 100M 
max_execution_time = 5000 
max_input_time = 5000 
memory_limit = 1000M 
</pre>

<p>Gem filen og åbn herefter filen <span class="inl_cmd">my.ini</span> i mappen <span class="inl_cmd">C:\xampp\mysql\bin</span></p>

<p>Ret linien <span class="inl_cmd">max_allowed_packet</span>, så den får størrelsen 100M</p>

<pre class="black">
max_allowed_packet = 100M
</pre>

<p>Herefter genstartes <span class="inl_cmd">Apache</span> og <span class="inl_cmd">MySQL</span> i XAMPP, og PHPMyAdmin genindlæses hvis det ikke har været lukket ned.</p>

<span class="afsnit">... på Mac</span>

<p>For at redigere i konfigurationsfilerne skal du åbne terminalen og indtaste følgende kommando.</p>

<code class="cmd">sudo nano /private/etc/php.ini.default</code>

<p>Indtast dit kodeord, og <span class="inl_cmd">nano</span> starter.</p>

<p>Tast <kbd>Ctrl</kbd>+<kbd>W</kbd>+<kbd>V</kbd> så cursoren går til slutningen af dokumentet.</p>

<p>Kopier nedestående og indsæt det</p>

<pre class="black">
post_max_size = 100M 
upload_max_filesize = 100M 
max_execution_time = 5000 
max_input_time = 5000 
memory_limit = 1000M 
</pre>

<p>Gem filen ved at trykke:</p>

<ul class="none">
	<li><kbd>Ctrl</kbd>+<kbd>X</kbd></li>
	<li><kbd>Y</kbd></li>
	<li><kbd>Enter</kbd></li>
</ul>

<p>Herefter ændres der i filen <span class="inl_cmd">my.cnf</span></p>

<code class="cmd">sudo nano /Applications/XAMPP/xamppfiles/etc/my.cnf</code>

<p>Ændr feltet <span class="inl_cmd">max_allowed_packet</span>, så det får værdien 100:</p>

<code class="cmd">max_allowed_packet = 100</code>

<p>Gem filen som ovenfor</p>

<p>Herefter genstartes <span class="inl_cmd">Apache</span> og <span class="inl_cmd">MySQL</span> i XAMPP, og PHPMyAdmin genindlæses hvis det ikke har været lukket ned.</p>
	
</div><!-- end: col-md-9 -->

<footer>

	<p><a rel="license" href="http://creativecommons.org/licenses/by-nc-sa/4.0/"><img alt="Creative Commons licens" src="https://i.creativecommons.org/l/by-nc-sa/4.0/88x31.png" /></a>Indholdet på Vidas.dk er licenseret under <a rel="license" href="http://creativecommons.org/licenses/by-nc-sa/4.0/">CC BY-NC-SA 4.0</a> og er skrevet af Thomas Jensen. (<a href="../hvem_er_jeg.html" target="_blank">Læs mere</a>)</p>

</footer>
	
	
</div><!-- end: row-fluid -->

</div> <!-- end: container-fluid -->


<!-- SCRIPT SECTION -->
<script type="text/javascript" src="../js/jquery.min.js"></script>
<script type="text/javascript" src="../js/jquery-ui.min.js"></script>
<script type="text/javascript" src="../js/jquery.tocify.min.js"></script>
<script type="text/javascript" src="../js/bootstrap.min.js"></script>

<!-- PRETTYFY-->
<script src="https://cdn.rawgit.com/google/code-prettify/master/loader/run_prettify.js"></script>


<!-- HIGHLIGHT -->
	<script src="../js/highlight.pack.js" type="text/javascript"></script>
	<script>hljs.initHighlightingOnLoad();</script>

<!-- MATHJAX -->
<script type="text/javascript" 
	src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-MML-AM_CHTML">
</script>

<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  displayAlign: "left",
  displayIndent: "0em"
});
</script>


<!-- TOCIFY -->
<script>
	$(function() {var toc = $("#toc").tocify({ selectors: "h1, h2, h3, h4" }).data("toc-tocify"); });
</script>
<!-- GOOGLE ANALYTICS -->
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-89933285-1', 'auto');
  ga('send', 'pageview');
</script>

</body>
</html>
